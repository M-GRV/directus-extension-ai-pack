"use strict";var e=require("crypto"),t=require("node:http"),r=require("node:https"),n=require("node:zlib"),a=require("node:stream"),o=require("node:buffer"),s=require("node:util"),i=require("node:url"),l=require("node:net");require("node:fs"),require("node:path");var u,c,d="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};!function(e){e.assertEqual=e=>e,e.assertIs=function(e){},e.assertNever=function(e){throw new Error},e.arrayToEnum=e=>{const t={};for(const r of e)t[r]=r;return t},e.getValidEnumValues=t=>{const r=e.objectKeys(t).filter((e=>"number"!=typeof t[t[e]])),n={};for(const e of r)n[e]=t[e];return e.objectValues(n)},e.objectValues=t=>e.objectKeys(t).map((function(e){return t[e]})),e.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{const t=[];for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t},e.find=(e,t)=>{for(const r of e)if(t(r))return r},e.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e,t=" | "){return e.map((e=>"string"==typeof e?`'${e}'`:e)).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t}(u||(u={})),function(e){e.mergeShapes=(e,t)=>({...e,...t})}(c||(c={}));const h=u.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),f=e=>{switch(typeof e){case"undefined":return h.undefined;case"string":return h.string;case"number":return isNaN(e)?h.nan:h.number;case"boolean":return h.boolean;case"function":return h.function;case"bigint":return h.bigint;case"symbol":return h.symbol;case"object":return Array.isArray(e)?h.array:null===e?h.null:e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch?h.promise:"undefined"!=typeof Map&&e instanceof Map?h.map:"undefined"!=typeof Set&&e instanceof Set?h.set:"undefined"!=typeof Date&&e instanceof Date?h.date:h.object;default:return h.unknown}},p=u.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class m extends Error{constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(e){return e.message},r={_errors:[]},n=e=>{for(const a of e.issues)if("invalid_union"===a.code)a.unionErrors.map(n);else if("invalid_return_type"===a.code)n(a.returnTypeError);else if("invalid_arguments"===a.code)n(a.argumentsError);else if(0===a.path.length)r._errors.push(t(a));else{let e=r,n=0;for(;n<a.path.length;){const r=a.path[n];n===a.path.length-1?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(t(a))):e[r]=e[r]||{_errors:[]},e=e[r],n++}}};return n(this),r}static assert(e){if(!(e instanceof m))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,u.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){const t={},r=[];for(const n of this.issues)n.path.length>0?(t[n.path[0]]=t[n.path[0]]||[],t[n.path[0]].push(e(n))):r.push(e(n));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}m.create=e=>new m(e);const y=(e,t)=>{let r;switch(e.code){case p.invalid_type:r=e.received===h.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case p.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,u.jsonStringifyReplacer)}`;break;case p.unrecognized_keys:r=`Unrecognized key(s) in object: ${u.joinValues(e.keys,", ")}`;break;case p.invalid_union:r="Invalid input";break;case p.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${u.joinValues(e.options)}`;break;case p.invalid_enum_value:r=`Invalid enum value. Expected ${u.joinValues(e.options)}, received '${e.received}'`;break;case p.invalid_arguments:r="Invalid function arguments";break;case p.invalid_return_type:r="Invalid function return type";break;case p.invalid_date:r="Invalid date";break;case p.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:u.assertNever(e.validation):r="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case p.too_small:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case p.too_big:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case p.custom:r="Invalid input";break;case p.invalid_intersection_types:r="Intersection results could not be merged";break;case p.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case p.not_finite:r="Number must be finite";break;default:r=t.defaultError,u.assertNever(e)}return{message:r}};let _=y;function g(){return _}const b=e=>{const{data:t,path:r,errorMaps:n,issueData:a}=e,o=[...r,...a.path||[]],s={...a,path:o};if(void 0!==a.message)return{...a,path:o,message:a.message};let i="";const l=n.filter((e=>!!e)).slice().reverse();for(const e of l)i=e(s,{data:t,defaultError:i}).message;return{...a,path:o,message:i}};function v(e,t){const r=g(),n=b({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===y?void 0:y].filter((e=>!!e))});e.common.issues.push(n)}class w{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){const r=[];for(const n of t){if("aborted"===n.status)return S;"dirty"===n.status&&e.dirty(),r.push(n.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){const r=[];for(const e of t){const t=await e.key,n=await e.value;r.push({key:t,value:n})}return w.mergeObjectSync(e,r)}static mergeObjectSync(e,t){const r={};for(const n of t){const{key:t,value:a}=n;if("aborted"===t.status)return S;if("aborted"===a.status)return S;"dirty"===t.status&&e.dirty(),"dirty"===a.status&&e.dirty(),"__proto__"===t.value||void 0===a.value&&!n.alwaysSet||(r[t.value]=a.value)}return{status:e.value,value:r}}}const S=Object.freeze({status:"aborted"}),T=e=>({status:"dirty",value:e}),k=e=>({status:"valid",value:e}),E=e=>"aborted"===e.status,R=e=>"dirty"===e.status,x=e=>"valid"===e.status,P=e=>"undefined"!=typeof Promise&&e instanceof Promise;function C(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function A(e,t,r,n,a){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?a.call(e,r):a?a.value=r:t.set(e,r),r}var O,j,q;"function"==typeof SuppressedError&&SuppressedError,function(e){e.errToObj=e=>"string"==typeof e?{message:e}:e||{},e.toString=e=>"string"==typeof e?e:null==e?void 0:e.message}(O||(O={}));class I{constructor(e,t,r,n){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const L=(e,t)=>{if(x(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new m(e.common.issues);return this._error=t,this._error}}};function $(e){if(!e)return{};const{errorMap:t,invalid_type_error:r,required_error:n,description:a}=e;if(t&&(r||n))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');if(t)return{errorMap:t,description:a};return{errorMap:(t,a)=>{var o,s;const{message:i}=e;return"invalid_enum_value"===t.code?{message:null!=i?i:a.defaultError}:void 0===a.data?{message:null!==(o=null!=i?i:n)&&void 0!==o?o:a.defaultError}:"invalid_type"!==t.code?{message:a.defaultError}:{message:null!==(s=null!=i?i:r)&&void 0!==s?s:a.defaultError}},description:a}}class Z{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return f(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:f(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new w,ctx:{common:e.parent.common,data:e.data,parsedType:f(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(P(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){var r;const n={common:{issues:[],async:null!==(r=null==t?void 0:t.async)&&void 0!==r&&r,contextualErrorMap:null==t?void 0:t.errorMap},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:f(e)},a=this._parseSync({data:e,path:n.path,parent:n});return L(n,a)}async parseAsync(e,t){const r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){const r={common:{issues:[],contextualErrorMap:null==t?void 0:t.errorMap,async:!0},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:f(e)},n=this._parse({data:e,path:r.path,parent:r}),a=await(P(n)?n:Promise.resolve(n));return L(r,a)}refine(e,t){const r=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement(((t,n)=>{const a=e(t),o=()=>n.addIssue({code:p.custom,...r(t)});return"undefined"!=typeof Promise&&a instanceof Promise?a.then((e=>!!e||(o(),!1))):!!a||(o(),!1)}))}refinement(e,t){return this._refinement(((r,n)=>!!e(r)||(n.addIssue("function"==typeof t?t(r,n):t),!1)))}_refinement(e){return new Oe({schema:this,typeName:We.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return je.create(this,this._def)}nullable(){return qe.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return he.create(this,this._def)}promise(){return Ae.create(this,this._def)}or(e){return me.create([this,e],this._def)}and(e){return be.create(this,e,this._def)}transform(e){return new Oe({...$(this._def),schema:this,typeName:We.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t="function"==typeof e?e:()=>e;return new Ie({...$(this._def),innerType:this,defaultValue:t,typeName:We.ZodDefault})}brand(){return new Ne({typeName:We.ZodBranded,type:this,...$(this._def)})}catch(e){const t="function"==typeof e?e:()=>e;return new Le({...$(this._def),innerType:this,catchValue:t,typeName:We.ZodCatch})}describe(e){return new(0,this.constructor)({...this._def,description:e})}pipe(e){return Be.create(this,e)}readonly(){return ze.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const N=/^c[^\s-]{8,}$/i,B=/^[0-9a-z]+$/,z=/^[0-9A-HJKMNP-TV-Z]{26}$/,D=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,M=/^[a-z0-9_-]{21}$/i,W=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,F=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i;let U;const H=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,V=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,K=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Y="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",G=new RegExp(`^${Y}$`);function Q(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`),t}function J(e){let t=`${Y}T${Q(e)}`;const r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}class X extends Z{_parse(e){this._def.coerce&&(e.data=String(e.data));if(this._getType(e)!==h.string){const t=this._getOrReturnCtx(e);return v(t,{code:p.invalid_type,expected:h.string,received:t.parsedType}),S}const t=new w;let r;for(const o of this._def.checks)if("min"===o.kind)e.data.length<o.value&&(r=this._getOrReturnCtx(e,r),v(r,{code:p.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),t.dirty());else if("max"===o.kind)e.data.length>o.value&&(r=this._getOrReturnCtx(e,r),v(r,{code:p.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),t.dirty());else if("length"===o.kind){const n=e.data.length>o.value,a=e.data.length<o.value;(n||a)&&(r=this._getOrReturnCtx(e,r),n?v(r,{code:p.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}):a&&v(r,{code:p.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}),t.dirty())}else if("email"===o.kind)F.test(e.data)||(r=this._getOrReturnCtx(e,r),v(r,{validation:"email",code:p.invalid_string,message:o.message}),t.dirty());else if("emoji"===o.kind)U||(U=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),U.test(e.data)||(r=this._getOrReturnCtx(e,r),v(r,{validation:"emoji",code:p.invalid_string,message:o.message}),t.dirty());else if("uuid"===o.kind)D.test(e.data)||(r=this._getOrReturnCtx(e,r),v(r,{validation:"uuid",code:p.invalid_string,message:o.message}),t.dirty());else if("nanoid"===o.kind)M.test(e.data)||(r=this._getOrReturnCtx(e,r),v(r,{validation:"nanoid",code:p.invalid_string,message:o.message}),t.dirty());else if("cuid"===o.kind)N.test(e.data)||(r=this._getOrReturnCtx(e,r),v(r,{validation:"cuid",code:p.invalid_string,message:o.message}),t.dirty());else if("cuid2"===o.kind)B.test(e.data)||(r=this._getOrReturnCtx(e,r),v(r,{validation:"cuid2",code:p.invalid_string,message:o.message}),t.dirty());else if("ulid"===o.kind)z.test(e.data)||(r=this._getOrReturnCtx(e,r),v(r,{validation:"ulid",code:p.invalid_string,message:o.message}),t.dirty());else if("url"===o.kind)try{new URL(e.data)}catch(n){r=this._getOrReturnCtx(e,r),v(r,{validation:"url",code:p.invalid_string,message:o.message}),t.dirty()}else if("regex"===o.kind){o.regex.lastIndex=0;o.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),v(r,{validation:"regex",code:p.invalid_string,message:o.message}),t.dirty())}else if("trim"===o.kind)e.data=e.data.trim();else if("includes"===o.kind)e.data.includes(o.value,o.position)||(r=this._getOrReturnCtx(e,r),v(r,{code:p.invalid_string,validation:{includes:o.value,position:o.position},message:o.message}),t.dirty());else if("toLowerCase"===o.kind)e.data=e.data.toLowerCase();else if("toUpperCase"===o.kind)e.data=e.data.toUpperCase();else if("startsWith"===o.kind)e.data.startsWith(o.value)||(r=this._getOrReturnCtx(e,r),v(r,{code:p.invalid_string,validation:{startsWith:o.value},message:o.message}),t.dirty());else if("endsWith"===o.kind)e.data.endsWith(o.value)||(r=this._getOrReturnCtx(e,r),v(r,{code:p.invalid_string,validation:{endsWith:o.value},message:o.message}),t.dirty());else if("datetime"===o.kind){J(o).test(e.data)||(r=this._getOrReturnCtx(e,r),v(r,{code:p.invalid_string,validation:"datetime",message:o.message}),t.dirty())}else if("date"===o.kind){G.test(e.data)||(r=this._getOrReturnCtx(e,r),v(r,{code:p.invalid_string,validation:"date",message:o.message}),t.dirty())}else if("time"===o.kind){new RegExp(`^${Q(o)}$`).test(e.data)||(r=this._getOrReturnCtx(e,r),v(r,{code:p.invalid_string,validation:"time",message:o.message}),t.dirty())}else"duration"===o.kind?W.test(e.data)||(r=this._getOrReturnCtx(e,r),v(r,{validation:"duration",code:p.invalid_string,message:o.message}),t.dirty()):"ip"===o.kind?(n=e.data,("v4"!==(a=o.version)&&a||!H.test(n))&&("v6"!==a&&a||!V.test(n))&&(r=this._getOrReturnCtx(e,r),v(r,{validation:"ip",code:p.invalid_string,message:o.message}),t.dirty())):"base64"===o.kind?K.test(e.data)||(r=this._getOrReturnCtx(e,r),v(r,{validation:"base64",code:p.invalid_string,message:o.message}),t.dirty()):u.assertNever(o);var n,a;return{status:t.value,value:e.data}}_regex(e,t,r){return this.refinement((t=>e.test(t)),{validation:t,code:p.invalid_string,...O.errToObj(r)})}_addCheck(e){return new X({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...O.errToObj(e)})}url(e){return this._addCheck({kind:"url",...O.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...O.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...O.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...O.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...O.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...O.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...O.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...O.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...O.errToObj(e)})}datetime(e){var t,r;return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,offset:null!==(t=null==e?void 0:e.offset)&&void 0!==t&&t,local:null!==(r=null==e?void 0:e.local)&&void 0!==r&&r,...O.errToObj(null==e?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,...O.errToObj(null==e?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...O.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...O.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:null==t?void 0:t.position,...O.errToObj(null==t?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...O.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...O.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...O.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...O.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...O.errToObj(t)})}nonempty(e){return this.min(1,O.errToObj(e))}trim(){return new X({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new X({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new X({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find((e=>"datetime"===e.kind))}get isDate(){return!!this._def.checks.find((e=>"date"===e.kind))}get isTime(){return!!this._def.checks.find((e=>"time"===e.kind))}get isDuration(){return!!this._def.checks.find((e=>"duration"===e.kind))}get isEmail(){return!!this._def.checks.find((e=>"email"===e.kind))}get isURL(){return!!this._def.checks.find((e=>"url"===e.kind))}get isEmoji(){return!!this._def.checks.find((e=>"emoji"===e.kind))}get isUUID(){return!!this._def.checks.find((e=>"uuid"===e.kind))}get isNANOID(){return!!this._def.checks.find((e=>"nanoid"===e.kind))}get isCUID(){return!!this._def.checks.find((e=>"cuid"===e.kind))}get isCUID2(){return!!this._def.checks.find((e=>"cuid2"===e.kind))}get isULID(){return!!this._def.checks.find((e=>"ulid"===e.kind))}get isIP(){return!!this._def.checks.find((e=>"ip"===e.kind))}get isBase64(){return!!this._def.checks.find((e=>"base64"===e.kind))}get minLength(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}function ee(e,t){const r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,a=r>n?r:n;return parseInt(e.toFixed(a).replace(".",""))%parseInt(t.toFixed(a).replace(".",""))/Math.pow(10,a)}X.create=e=>{var t;return new X({checks:[],typeName:We.ZodString,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...$(e)})};class te extends Z{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){this._def.coerce&&(e.data=Number(e.data));if(this._getType(e)!==h.number){const t=this._getOrReturnCtx(e);return v(t,{code:p.invalid_type,expected:h.number,received:t.parsedType}),S}let t;const r=new w;for(const n of this._def.checks)if("int"===n.kind)u.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),v(t,{code:p.invalid_type,expected:"integer",received:"float",message:n.message}),r.dirty());else if("min"===n.kind){(n.inclusive?e.data<n.value:e.data<=n.value)&&(t=this._getOrReturnCtx(e,t),v(t,{code:p.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty())}else if("max"===n.kind){(n.inclusive?e.data>n.value:e.data>=n.value)&&(t=this._getOrReturnCtx(e,t),v(t,{code:p.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty())}else"multipleOf"===n.kind?0!==ee(e.data,n.value)&&(t=this._getOrReturnCtx(e,t),v(t,{code:p.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):"finite"===n.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),v(t,{code:p.not_finite,message:n.message}),r.dirty()):u.assertNever(n);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,O.toString(t))}gt(e,t){return this.setLimit("min",e,!1,O.toString(t))}lte(e,t){return this.setLimit("max",e,!0,O.toString(t))}lt(e,t){return this.setLimit("max",e,!1,O.toString(t))}setLimit(e,t,r,n){return new te({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:O.toString(n)}]})}_addCheck(e){return new te({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:O.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:O.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:O.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:O.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:O.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:O.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:O.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:O.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:O.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find((e=>"int"===e.kind||"multipleOf"===e.kind&&u.isInteger(e.value)))}get isFinite(){let e=null,t=null;for(const r of this._def.checks){if("finite"===r.kind||"int"===r.kind||"multipleOf"===r.kind)return!0;"min"===r.kind?(null===t||r.value>t)&&(t=r.value):"max"===r.kind&&(null===e||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}te.create=e=>new te({checks:[],typeName:We.ZodNumber,coerce:(null==e?void 0:e.coerce)||!1,...$(e)});class re extends Z{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){this._def.coerce&&(e.data=BigInt(e.data));if(this._getType(e)!==h.bigint){const t=this._getOrReturnCtx(e);return v(t,{code:p.invalid_type,expected:h.bigint,received:t.parsedType}),S}let t;const r=new w;for(const n of this._def.checks)if("min"===n.kind){(n.inclusive?e.data<n.value:e.data<=n.value)&&(t=this._getOrReturnCtx(e,t),v(t,{code:p.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty())}else if("max"===n.kind){(n.inclusive?e.data>n.value:e.data>=n.value)&&(t=this._getOrReturnCtx(e,t),v(t,{code:p.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty())}else"multipleOf"===n.kind?e.data%n.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),v(t,{code:p.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):u.assertNever(n);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,O.toString(t))}gt(e,t){return this.setLimit("min",e,!1,O.toString(t))}lte(e,t){return this.setLimit("max",e,!0,O.toString(t))}lt(e,t){return this.setLimit("max",e,!1,O.toString(t))}setLimit(e,t,r,n){return new re({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:O.toString(n)}]})}_addCheck(e){return new re({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:O.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:O.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:O.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:O.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:O.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}re.create=e=>{var t;return new re({checks:[],typeName:We.ZodBigInt,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...$(e)})};class ne extends Z{_parse(e){this._def.coerce&&(e.data=Boolean(e.data));if(this._getType(e)!==h.boolean){const t=this._getOrReturnCtx(e);return v(t,{code:p.invalid_type,expected:h.boolean,received:t.parsedType}),S}return k(e.data)}}ne.create=e=>new ne({typeName:We.ZodBoolean,coerce:(null==e?void 0:e.coerce)||!1,...$(e)});class ae extends Z{_parse(e){this._def.coerce&&(e.data=new Date(e.data));if(this._getType(e)!==h.date){const t=this._getOrReturnCtx(e);return v(t,{code:p.invalid_type,expected:h.date,received:t.parsedType}),S}if(isNaN(e.data.getTime())){return v(this._getOrReturnCtx(e),{code:p.invalid_date}),S}const t=new w;let r;for(const n of this._def.checks)"min"===n.kind?e.data.getTime()<n.value&&(r=this._getOrReturnCtx(e,r),v(r,{code:p.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),t.dirty()):"max"===n.kind?e.data.getTime()>n.value&&(r=this._getOrReturnCtx(e,r),v(r,{code:p.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),t.dirty()):u.assertNever(n);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(e){return new ae({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:O.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:O.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}ae.create=e=>new ae({checks:[],coerce:(null==e?void 0:e.coerce)||!1,typeName:We.ZodDate,...$(e)});class oe extends Z{_parse(e){if(this._getType(e)!==h.symbol){const t=this._getOrReturnCtx(e);return v(t,{code:p.invalid_type,expected:h.symbol,received:t.parsedType}),S}return k(e.data)}}oe.create=e=>new oe({typeName:We.ZodSymbol,...$(e)});class se extends Z{_parse(e){if(this._getType(e)!==h.undefined){const t=this._getOrReturnCtx(e);return v(t,{code:p.invalid_type,expected:h.undefined,received:t.parsedType}),S}return k(e.data)}}se.create=e=>new se({typeName:We.ZodUndefined,...$(e)});class ie extends Z{_parse(e){if(this._getType(e)!==h.null){const t=this._getOrReturnCtx(e);return v(t,{code:p.invalid_type,expected:h.null,received:t.parsedType}),S}return k(e.data)}}ie.create=e=>new ie({typeName:We.ZodNull,...$(e)});class le extends Z{constructor(){super(...arguments),this._any=!0}_parse(e){return k(e.data)}}le.create=e=>new le({typeName:We.ZodAny,...$(e)});class ue extends Z{constructor(){super(...arguments),this._unknown=!0}_parse(e){return k(e.data)}}ue.create=e=>new ue({typeName:We.ZodUnknown,...$(e)});class ce extends Z{_parse(e){const t=this._getOrReturnCtx(e);return v(t,{code:p.invalid_type,expected:h.never,received:t.parsedType}),S}}ce.create=e=>new ce({typeName:We.ZodNever,...$(e)});class de extends Z{_parse(e){if(this._getType(e)!==h.undefined){const t=this._getOrReturnCtx(e);return v(t,{code:p.invalid_type,expected:h.void,received:t.parsedType}),S}return k(e.data)}}de.create=e=>new de({typeName:We.ZodVoid,...$(e)});class he extends Z{_parse(e){const{ctx:t,status:r}=this._processInputParams(e),n=this._def;if(t.parsedType!==h.array)return v(t,{code:p.invalid_type,expected:h.array,received:t.parsedType}),S;if(null!==n.exactLength){const e=t.data.length>n.exactLength.value,a=t.data.length<n.exactLength.value;(e||a)&&(v(t,{code:e?p.too_big:p.too_small,minimum:a?n.exactLength.value:void 0,maximum:e?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),r.dirty())}if(null!==n.minLength&&t.data.length<n.minLength.value&&(v(t,{code:p.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),r.dirty()),null!==n.maxLength&&t.data.length>n.maxLength.value&&(v(t,{code:p.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map(((e,r)=>n.type._parseAsync(new I(t,e,t.path,r))))).then((e=>w.mergeArray(r,e)));const a=[...t.data].map(((e,r)=>n.type._parseSync(new I(t,e,t.path,r))));return w.mergeArray(r,a)}get element(){return this._def.type}min(e,t){return new he({...this._def,minLength:{value:e,message:O.toString(t)}})}max(e,t){return new he({...this._def,maxLength:{value:e,message:O.toString(t)}})}length(e,t){return new he({...this._def,exactLength:{value:e,message:O.toString(t)}})}nonempty(e){return this.min(1,e)}}function fe(e){if(e instanceof pe){const t={};for(const r in e.shape){const n=e.shape[r];t[r]=je.create(fe(n))}return new pe({...e._def,shape:()=>t})}return e instanceof he?new he({...e._def,type:fe(e.element)}):e instanceof je?je.create(fe(e.unwrap())):e instanceof qe?qe.create(fe(e.unwrap())):e instanceof ve?ve.create(e.items.map((e=>fe(e)))):e}he.create=(e,t)=>new he({type:e,minLength:null,maxLength:null,exactLength:null,typeName:We.ZodArray,...$(t)});class pe extends Z{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const e=this._def.shape(),t=u.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==h.object){const t=this._getOrReturnCtx(e);return v(t,{code:p.invalid_type,expected:h.object,received:t.parsedType}),S}const{status:t,ctx:r}=this._processInputParams(e),{shape:n,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof ce&&"strip"===this._def.unknownKeys))for(const e in r.data)a.includes(e)||o.push(e);const s=[];for(const e of a){const t=n[e],a=r.data[e];s.push({key:{status:"valid",value:e},value:t._parse(new I(r,a,r.path,e)),alwaysSet:e in r.data})}if(this._def.catchall instanceof ce){const e=this._def.unknownKeys;if("passthrough"===e)for(const e of o)s.push({key:{status:"valid",value:e},value:{status:"valid",value:r.data[e]}});else if("strict"===e)o.length>0&&(v(r,{code:p.unrecognized_keys,keys:o}),t.dirty());else if("strip"!==e)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const e=this._def.catchall;for(const t of o){const n=r.data[t];s.push({key:{status:"valid",value:t},value:e._parse(new I(r,n,r.path,t)),alwaysSet:t in r.data})}}return r.common.async?Promise.resolve().then((async()=>{const e=[];for(const t of s){const r=await t.key,n=await t.value;e.push({key:r,value:n,alwaysSet:t.alwaysSet})}return e})).then((e=>w.mergeObjectSync(t,e))):w.mergeObjectSync(t,s)}get shape(){return this._def.shape()}strict(e){return O.errToObj,new pe({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,r)=>{var n,a,o,s;const i=null!==(o=null===(a=(n=this._def).errorMap)||void 0===a?void 0:a.call(n,t,r).message)&&void 0!==o?o:r.defaultError;return"unrecognized_keys"===t.code?{message:null!==(s=O.errToObj(e).message)&&void 0!==s?s:i}:{message:i}}}:{}})}strip(){return new pe({...this._def,unknownKeys:"strip"})}passthrough(){return new pe({...this._def,unknownKeys:"passthrough"})}extend(e){return new pe({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new pe({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:We.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new pe({...this._def,catchall:e})}pick(e){const t={};return u.objectKeys(e).forEach((r=>{e[r]&&this.shape[r]&&(t[r]=this.shape[r])})),new pe({...this._def,shape:()=>t})}omit(e){const t={};return u.objectKeys(this.shape).forEach((r=>{e[r]||(t[r]=this.shape[r])})),new pe({...this._def,shape:()=>t})}deepPartial(){return fe(this)}partial(e){const t={};return u.objectKeys(this.shape).forEach((r=>{const n=this.shape[r];e&&!e[r]?t[r]=n:t[r]=n.optional()})),new pe({...this._def,shape:()=>t})}required(e){const t={};return u.objectKeys(this.shape).forEach((r=>{if(e&&!e[r])t[r]=this.shape[r];else{let e=this.shape[r];for(;e instanceof je;)e=e._def.innerType;t[r]=e}})),new pe({...this._def,shape:()=>t})}keyof(){return xe(u.objectKeys(this.shape))}}pe.create=(e,t)=>new pe({shape:()=>e,unknownKeys:"strip",catchall:ce.create(),typeName:We.ZodObject,...$(t)}),pe.strictCreate=(e,t)=>new pe({shape:()=>e,unknownKeys:"strict",catchall:ce.create(),typeName:We.ZodObject,...$(t)}),pe.lazycreate=(e,t)=>new pe({shape:e,unknownKeys:"strip",catchall:ce.create(),typeName:We.ZodObject,...$(t)});class me extends Z{_parse(e){const{ctx:t}=this._processInputParams(e),r=this._def.options;if(t.common.async)return Promise.all(r.map((async e=>{const r={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:r}),ctx:r}}))).then((function(e){for(const t of e)if("valid"===t.result.status)return t.result;for(const r of e)if("dirty"===r.result.status)return t.common.issues.push(...r.ctx.common.issues),r.result;const r=e.map((e=>new m(e.ctx.common.issues)));return v(t,{code:p.invalid_union,unionErrors:r}),S}));{let e;const n=[];for(const a of r){const r={...t,common:{...t.common,issues:[]},parent:null},o=a._parseSync({data:t.data,path:t.path,parent:r});if("valid"===o.status)return o;"dirty"!==o.status||e||(e={result:o,ctx:r}),r.common.issues.length&&n.push(r.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;const a=n.map((e=>new m(e)));return v(t,{code:p.invalid_union,unionErrors:a}),S}}get options(){return this._def.options}}me.create=(e,t)=>new me({options:e,typeName:We.ZodUnion,...$(t)});const ye=e=>e instanceof Ee?ye(e.schema):e instanceof Oe?ye(e.innerType()):e instanceof Re?[e.value]:e instanceof Pe?e.options:e instanceof Ce?u.objectValues(e.enum):e instanceof Ie?ye(e._def.innerType):e instanceof se?[void 0]:e instanceof ie?[null]:e instanceof je?[void 0,...ye(e.unwrap())]:e instanceof qe?[null,...ye(e.unwrap())]:e instanceof Ne||e instanceof ze?ye(e.unwrap()):e instanceof Le?ye(e._def.innerType):[];class _e extends Z{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==h.object)return v(t,{code:p.invalid_type,expected:h.object,received:t.parsedType}),S;const r=this.discriminator,n=t.data[r],a=this.optionsMap.get(n);return a?t.common.async?a._parseAsync({data:t.data,path:t.path,parent:t}):a._parseSync({data:t.data,path:t.path,parent:t}):(v(t,{code:p.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),S)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){const n=new Map;for(const r of t){const t=ye(r.shape[e]);if(!t.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of t){if(n.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);n.set(a,r)}}return new _e({typeName:We.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:n,...$(r)})}}function ge(e,t){const r=f(e),n=f(t);if(e===t)return{valid:!0,data:e};if(r===h.object&&n===h.object){const r=u.objectKeys(t),n=u.objectKeys(e).filter((e=>-1!==r.indexOf(e))),a={...e,...t};for(const r of n){const n=ge(e[r],t[r]);if(!n.valid)return{valid:!1};a[r]=n.data}return{valid:!0,data:a}}if(r===h.array&&n===h.array){if(e.length!==t.length)return{valid:!1};const r=[];for(let n=0;n<e.length;n++){const a=ge(e[n],t[n]);if(!a.valid)return{valid:!1};r.push(a.data)}return{valid:!0,data:r}}return r===h.date&&n===h.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class be extends Z{_parse(e){const{status:t,ctx:r}=this._processInputParams(e),n=(e,n)=>{if(E(e)||E(n))return S;const a=ge(e.value,n.value);return a.valid?((R(e)||R(n))&&t.dirty(),{status:t.value,value:a.data}):(v(r,{code:p.invalid_intersection_types}),S)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then((([e,t])=>n(e,t))):n(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}be.create=(e,t,r)=>new be({left:e,right:t,typeName:We.ZodIntersection,...$(r)});class ve extends Z{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==h.array)return v(r,{code:p.invalid_type,expected:h.array,received:r.parsedType}),S;if(r.data.length<this._def.items.length)return v(r,{code:p.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),S;!this._def.rest&&r.data.length>this._def.items.length&&(v(r,{code:p.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const n=[...r.data].map(((e,t)=>{const n=this._def.items[t]||this._def.rest;return n?n._parse(new I(r,e,r.path,t)):null})).filter((e=>!!e));return r.common.async?Promise.all(n).then((e=>w.mergeArray(t,e))):w.mergeArray(t,n)}get items(){return this._def.items}rest(e){return new ve({...this._def,rest:e})}}ve.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ve({items:e,typeName:We.ZodTuple,rest:null,...$(t)})};class we extends Z{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==h.object)return v(r,{code:p.invalid_type,expected:h.object,received:r.parsedType}),S;const n=[],a=this._def.keyType,o=this._def.valueType;for(const e in r.data)n.push({key:a._parse(new I(r,e,r.path,e)),value:o._parse(new I(r,r.data[e],r.path,e)),alwaysSet:e in r.data});return r.common.async?w.mergeObjectAsync(t,n):w.mergeObjectSync(t,n)}get element(){return this._def.valueType}static create(e,t,r){return new we(t instanceof Z?{keyType:e,valueType:t,typeName:We.ZodRecord,...$(r)}:{keyType:X.create(),valueType:e,typeName:We.ZodRecord,...$(t)})}}class Se extends Z{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==h.map)return v(r,{code:p.invalid_type,expected:h.map,received:r.parsedType}),S;const n=this._def.keyType,a=this._def.valueType,o=[...r.data.entries()].map((([e,t],o)=>({key:n._parse(new I(r,e,r.path,[o,"key"])),value:a._parse(new I(r,t,r.path,[o,"value"]))})));if(r.common.async){const e=new Map;return Promise.resolve().then((async()=>{for(const r of o){const n=await r.key,a=await r.value;if("aborted"===n.status||"aborted"===a.status)return S;"dirty"!==n.status&&"dirty"!==a.status||t.dirty(),e.set(n.value,a.value)}return{status:t.value,value:e}}))}{const e=new Map;for(const r of o){const n=r.key,a=r.value;if("aborted"===n.status||"aborted"===a.status)return S;"dirty"!==n.status&&"dirty"!==a.status||t.dirty(),e.set(n.value,a.value)}return{status:t.value,value:e}}}}Se.create=(e,t,r)=>new Se({valueType:t,keyType:e,typeName:We.ZodMap,...$(r)});class Te extends Z{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==h.set)return v(r,{code:p.invalid_type,expected:h.set,received:r.parsedType}),S;const n=this._def;null!==n.minSize&&r.data.size<n.minSize.value&&(v(r,{code:p.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),t.dirty()),null!==n.maxSize&&r.data.size>n.maxSize.value&&(v(r,{code:p.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),t.dirty());const a=this._def.valueType;function o(e){const r=new Set;for(const n of e){if("aborted"===n.status)return S;"dirty"===n.status&&t.dirty(),r.add(n.value)}return{status:t.value,value:r}}const s=[...r.data.values()].map(((e,t)=>a._parse(new I(r,e,r.path,t))));return r.common.async?Promise.all(s).then((e=>o(e))):o(s)}min(e,t){return new Te({...this._def,minSize:{value:e,message:O.toString(t)}})}max(e,t){return new Te({...this._def,maxSize:{value:e,message:O.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}Te.create=(e,t)=>new Te({valueType:e,minSize:null,maxSize:null,typeName:We.ZodSet,...$(t)});class ke extends Z{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==h.function)return v(t,{code:p.invalid_type,expected:h.function,received:t.parsedType}),S;function r(e,r){return b({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,g(),y].filter((e=>!!e)),issueData:{code:p.invalid_arguments,argumentsError:r}})}function n(e,r){return b({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,g(),y].filter((e=>!!e)),issueData:{code:p.invalid_return_type,returnTypeError:r}})}const a={errorMap:t.common.contextualErrorMap},o=t.data;if(this._def.returns instanceof Ae){const e=this;return k((async function(...t){const s=new m([]),i=await e._def.args.parseAsync(t,a).catch((e=>{throw s.addIssue(r(t,e)),s})),l=await Reflect.apply(o,this,i),u=await e._def.returns._def.type.parseAsync(l,a).catch((e=>{throw s.addIssue(n(l,e)),s}));return u}))}{const e=this;return k((function(...t){const s=e._def.args.safeParse(t,a);if(!s.success)throw new m([r(t,s.error)]);const i=Reflect.apply(o,this,s.data),l=e._def.returns.safeParse(i,a);if(!l.success)throw new m([n(i,l.error)]);return l.data}))}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new ke({...this._def,args:ve.create(e).rest(ue.create())})}returns(e){return new ke({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new ke({args:e||ve.create([]).rest(ue.create()),returns:t||ue.create(),typeName:We.ZodFunction,...$(r)})}}class Ee extends Z{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}Ee.create=(e,t)=>new Ee({getter:e,typeName:We.ZodLazy,...$(t)});class Re extends Z{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return v(t,{received:t.data,code:p.invalid_literal,expected:this._def.value}),S}return{status:"valid",value:e.data}}get value(){return this._def.value}}function xe(e,t){return new Pe({values:e,typeName:We.ZodEnum,...$(t)})}Re.create=(e,t)=>new Re({value:e,typeName:We.ZodLiteral,...$(t)});class Pe extends Z{constructor(){super(...arguments),j.set(this,void 0)}_parse(e){if("string"!=typeof e.data){const t=this._getOrReturnCtx(e),r=this._def.values;return v(t,{expected:u.joinValues(r),received:t.parsedType,code:p.invalid_type}),S}if(C(this,j,"f")||A(this,j,new Set(this._def.values),"f"),!C(this,j,"f").has(e.data)){const t=this._getOrReturnCtx(e),r=this._def.values;return v(t,{received:t.data,code:p.invalid_enum_value,options:r}),S}return k(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Pe.create(e,{...this._def,...t})}exclude(e,t=this._def){return Pe.create(this.options.filter((t=>!e.includes(t))),{...this._def,...t})}}j=new WeakMap,Pe.create=xe;class Ce extends Z{constructor(){super(...arguments),q.set(this,void 0)}_parse(e){const t=u.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==h.string&&r.parsedType!==h.number){const e=u.objectValues(t);return v(r,{expected:u.joinValues(e),received:r.parsedType,code:p.invalid_type}),S}if(C(this,q,"f")||A(this,q,new Set(u.getValidEnumValues(this._def.values)),"f"),!C(this,q,"f").has(e.data)){const e=u.objectValues(t);return v(r,{received:r.data,code:p.invalid_enum_value,options:e}),S}return k(e.data)}get enum(){return this._def.values}}q=new WeakMap,Ce.create=(e,t)=>new Ce({values:e,typeName:We.ZodNativeEnum,...$(t)});class Ae extends Z{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==h.promise&&!1===t.common.async)return v(t,{code:p.invalid_type,expected:h.promise,received:t.parsedType}),S;const r=t.parsedType===h.promise?t.data:Promise.resolve(t.data);return k(r.then((e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap}))))}}Ae.create=(e,t)=>new Ae({type:e,typeName:We.ZodPromise,...$(t)});class Oe extends Z{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===We.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:r}=this._processInputParams(e),n=this._def.effect||null,a={addIssue:e=>{v(r,e),e.fatal?t.abort():t.dirty()},get path(){return r.path}};if(a.addIssue=a.addIssue.bind(a),"preprocess"===n.type){const e=n.transform(r.data,a);if(r.common.async)return Promise.resolve(e).then((async e=>{if("aborted"===t.value)return S;const n=await this._def.schema._parseAsync({data:e,path:r.path,parent:r});return"aborted"===n.status?S:"dirty"===n.status||"dirty"===t.value?T(n.value):n}));{if("aborted"===t.value)return S;const n=this._def.schema._parseSync({data:e,path:r.path,parent:r});return"aborted"===n.status?S:"dirty"===n.status||"dirty"===t.value?T(n.value):n}}if("refinement"===n.type){const e=e=>{const t=n.refinement(e,a);if(r.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===r.common.async){const n=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===n.status?S:("dirty"===n.status&&t.dirty(),e(n.value),{status:t.value,value:n.value})}return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then((r=>"aborted"===r.status?S:("dirty"===r.status&&t.dirty(),e(r.value).then((()=>({status:t.value,value:r.value}))))))}if("transform"===n.type){if(!1===r.common.async){const e=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!x(e))return e;const o=n.transform(e.value,a);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:o}}return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then((e=>x(e)?Promise.resolve(n.transform(e.value,a)).then((e=>({status:t.value,value:e}))):e))}u.assertNever(n)}}Oe.create=(e,t,r)=>new Oe({schema:e,typeName:We.ZodEffects,effect:t,...$(r)}),Oe.createWithPreprocess=(e,t,r)=>new Oe({schema:t,effect:{type:"preprocess",transform:e},typeName:We.ZodEffects,...$(r)});class je extends Z{_parse(e){return this._getType(e)===h.undefined?k(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}je.create=(e,t)=>new je({innerType:e,typeName:We.ZodOptional,...$(t)});class qe extends Z{_parse(e){return this._getType(e)===h.null?k(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}qe.create=(e,t)=>new qe({innerType:e,typeName:We.ZodNullable,...$(t)});class Ie extends Z{_parse(e){const{ctx:t}=this._processInputParams(e);let r=t.data;return t.parsedType===h.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Ie.create=(e,t)=>new Ie({innerType:e,typeName:We.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...$(t)});class Le extends Z{_parse(e){const{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},n=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return P(n)?n.then((e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new m(r.common.issues)},input:r.data})}))):{status:"valid",value:"valid"===n.status?n.value:this._def.catchValue({get error(){return new m(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}Le.create=(e,t)=>new Le({innerType:e,typeName:We.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...$(t)});class $e extends Z{_parse(e){if(this._getType(e)!==h.nan){const t=this._getOrReturnCtx(e);return v(t,{code:p.invalid_type,expected:h.nan,received:t.parsedType}),S}return{status:"valid",value:e.data}}}$e.create=e=>new $e({typeName:We.ZodNaN,...$(e)});const Ze=Symbol("zod_brand");class Ne extends Z{_parse(e){const{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class Be extends Z{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.common.async){return(async()=>{const e=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?S:"dirty"===e.status?(t.dirty(),T(e.value)):this._def.out._parseAsync({data:e.value,path:r.path,parent:r})})()}{const e=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?S:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:r.path,parent:r})}}static create(e,t){return new Be({in:e,out:t,typeName:We.ZodPipeline})}}class ze extends Z{_parse(e){const t=this._def.innerType._parse(e),r=e=>(x(e)&&(e.value=Object.freeze(e.value)),e);return P(t)?t.then((e=>r(e))):r(t)}unwrap(){return this._def.innerType}}function De(e,t={},r){return e?le.create().superRefine(((n,a)=>{var o,s;if(!e(n)){const e="function"==typeof t?t(n):"string"==typeof t?{message:t}:t,i=null===(s=null!==(o=e.fatal)&&void 0!==o?o:r)||void 0===s||s,l="string"==typeof e?{message:e}:e;a.addIssue({code:"custom",...l,fatal:i})}})):le.create()}ze.create=(e,t)=>new ze({innerType:e,typeName:We.ZodReadonly,...$(t)});const Me={object:pe.lazycreate};var We;!function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(We||(We={}));const Fe=X.create,Ue=te.create,He=$e.create,Ve=re.create,Ke=ne.create,Ye=ae.create,Ge=oe.create,Qe=se.create,Je=ie.create,Xe=le.create,et=ue.create,tt=ce.create,rt=de.create,nt=he.create,at=pe.create,ot=pe.strictCreate,st=me.create,it=_e.create,lt=be.create,ut=ve.create,ct=we.create,dt=Se.create,ht=Te.create,ft=ke.create,pt=Ee.create,mt=Re.create,yt=Pe.create,_t=Ce.create,gt=Ae.create,bt=Oe.create,vt=je.create,wt=qe.create,St=Oe.createWithPreprocess,Tt=Be.create,kt={string:e=>X.create({...e,coerce:!0}),number:e=>te.create({...e,coerce:!0}),boolean:e=>ne.create({...e,coerce:!0}),bigint:e=>re.create({...e,coerce:!0}),date:e=>ae.create({...e,coerce:!0})},Et=S;var Rt=Object.freeze({__proto__:null,defaultErrorMap:y,setErrorMap:function(e){_=e},getErrorMap:g,makeIssue:b,EMPTY_PATH:[],addIssueToContext:v,ParseStatus:w,INVALID:S,DIRTY:T,OK:k,isAborted:E,isDirty:R,isValid:x,isAsync:P,get util(){return u},get objectUtil(){return c},ZodParsedType:h,getParsedType:f,ZodType:Z,datetimeRegex:J,ZodString:X,ZodNumber:te,ZodBigInt:re,ZodBoolean:ne,ZodDate:ae,ZodSymbol:oe,ZodUndefined:se,ZodNull:ie,ZodAny:le,ZodUnknown:ue,ZodNever:ce,ZodVoid:de,ZodArray:he,ZodObject:pe,ZodUnion:me,ZodDiscriminatedUnion:_e,ZodIntersection:be,ZodTuple:ve,ZodRecord:we,ZodMap:Se,ZodSet:Te,ZodFunction:ke,ZodLazy:Ee,ZodLiteral:Re,ZodEnum:Pe,ZodNativeEnum:Ce,ZodPromise:Ae,ZodEffects:Oe,ZodTransformer:Oe,ZodOptional:je,ZodNullable:qe,ZodDefault:Ie,ZodCatch:Le,ZodNaN:$e,BRAND:Ze,ZodBranded:Ne,ZodPipeline:Be,ZodReadonly:ze,custom:De,Schema:Z,ZodSchema:Z,late:Me,get ZodFirstPartyTypeKind(){return We},coerce:kt,any:Xe,array:nt,bigint:Ve,boolean:Ke,date:Ye,discriminatedUnion:it,effect:bt,enum:yt,function:ft,instanceof:(e,t={message:`Input not instance of ${e.name}`})=>De((t=>t instanceof e),t),intersection:lt,lazy:pt,literal:mt,map:dt,nan:He,nativeEnum:_t,never:tt,null:Je,nullable:wt,number:Ue,object:at,oboolean:()=>Ke().optional(),onumber:()=>Ue().optional(),optional:vt,ostring:()=>Fe().optional(),pipeline:Tt,preprocess:St,promise:gt,record:ct,set:ht,strictObject:ot,string:Fe,symbol:Ge,transformer:bt,tuple:ut,undefined:Qe,union:st,unknown:et,void:rt,NEVER:Et,ZodIssueCode:p,quotelessJson:e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),ZodError:m}),xt=["interface","display","layout","module","panel","theme"],Pt=["hook","endpoint"],Ct=["operation"],At="directus:extension",Ot=Rt.object({app:Rt.string(),api:Rt.string()}),jt=Rt.object({request:Rt.optional(Rt.object({urls:Rt.array(Rt.string()),methods:Rt.array(Rt.union([Rt.literal("GET"),Rt.literal("POST"),Rt.literal("PATCH"),Rt.literal("PUT"),Rt.literal("DELETE")]))})),log:Rt.optional(Rt.object({})),sleep:Rt.optional(Rt.object({}))}),qt=Rt.optional(Rt.object({enabled:Rt.boolean(),requestedScopes:jt})),It=Rt.union([Rt.object({type:Rt.enum(Pt),name:Rt.string(),source:Rt.string()}),Rt.object({type:Rt.enum(xt),name:Rt.string(),source:Rt.string()}),Rt.object({type:Rt.enum(Ct),name:Rt.string(),source:Ot})]),Lt=Rt.object({host:Rt.string(),hidden:Rt.boolean().optional()}),$t=Rt.object({type:Rt.enum(xt),path:Rt.string(),source:Rt.string()}),Zt=Rt.object({type:Rt.enum(Pt),path:Rt.string(),source:Rt.string(),sandbox:qt}),Nt=Rt.object({type:Rt.enum(Ct),path:Ot,source:Ot,sandbox:qt}),Bt=Rt.object({type:Rt.literal("bundle"),partial:Rt.boolean().optional(),path:Ot,entries:Rt.array(It)});Rt.array(It);var zt=Lt.and(Rt.union([$t,Zt,Nt,Bt]));Rt.object({name:Rt.string(),version:Rt.string(),type:Rt.union([Rt.literal("module"),Rt.literal("commonjs")]).optional(),description:Rt.string().optional(),icon:Rt.string().optional(),dependencies:Rt.record(Rt.string()).optional(),devDependencies:Rt.record(Rt.string()).optional(),[At]:zt});const Dt={collection:"directus_settings",field:"ai_pack_config",type:"alias",schema:null,meta:{collection:"directus_settings",field:"ai_pack_config",special:["alias","no-data","group"],interface:"group-detail",options:{headerIcon:"rocket_launch"},display:null,display_options:null,readonly:!1,hidden:!1,sort:null,width:"full",translations:null,note:null,conditions:null,required:!1,group:null,validation:null,validation_message:null}},Mt={collection:"directus_settings",field:"Default_GPT_Model",type:"string",schema:{name:"Default_GPT_Model",table:"directus_settings",data_type:"varchar",default_value:"gpt-4o",max_length:255,numeric_precision:null,numeric_scale:null,is_generated:!1,generation_expression:null,is_nullable:!0,is_unique:!1,is_primary_key:!1,has_auto_increment:!1,foreign_key_column:null,foreign_key_table:null},meta:{collection:"directus_settings",field:"Default_GPT_Model",special:null,interface:"select-dropdown",options:{choices:[{text:"GPT-4o",value:"gpt-4o"},{text:"GPT-4o mini",value:"gpt-4o-mini"},{text:"GPT-4 Turbo",value:"gpt-4-turbo-preview"},{text:"GPT-4",value:"gpt-4"},{text:"GPT-3.5 Turbo",value:"gpt-3.5-turbo"},{text:"GPT-3.5 Turbo 16K",value:"gpt-3.5-turbo-16k"}]},display:"formatted-value",display_options:null,readonly:!1,hidden:!1,sort:1,width:"full",translations:null,note:"Select the default GPT model to use for chat completions",conditions:null,required:!1,group:Dt.field,validation:null,validation_message:null}},Wt={collection:"directus_settings",field:"Open_AI_API_Key",type:"string",schema:{name:"Open_AI_API_Key",table:"directus_settings",data_type:"varchar",default_value:null,max_length:255,numeric_precision:null,numeric_scale:null,is_generated:!1,generation_expression:null,is_nullable:!0,is_unique:!1,is_primary_key:!1,has_auto_increment:!1,foreign_key_column:null,foreign_key_table:null},meta:{collection:"directus_settings",field:"Open_AI_API_Key",special:null,interface:"input",options:{masked:!0},display:null,display_options:null,readonly:!1,hidden:!1,sort:2,width:"full",translations:null,note:null,conditions:null,required:!1,group:Dt.field,validation:null,validation_message:null}},Ft={collection:"directus_settings",field:"Stability_AI_API_Key",type:"string",schema:{name:"Stability_AI_API_Key",table:"directus_settings",data_type:"varchar",default_value:null,max_length:255,numeric_precision:null,numeric_scale:null,is_generated:!1,generation_expression:null,is_nullable:!0,is_unique:!1,is_primary_key:!1,has_auto_increment:!1,foreign_key_column:null,foreign_key_table:null},meta:{collection:"directus_settings",field:"Stability_AI_API_Key",special:null,interface:"input",options:{masked:!0},display:null,display_options:null,readonly:!1,hidden:!1,sort:3,width:"full",translations:null,note:null,conditions:null,required:!1,group:Dt.field,validation:null,validation_message:null}};async function Ut(e,t,r){if(r)return r;const n=await e.readSingleton({fields:[t]}).catch((()=>!1));return n?n[t]:null}const Ht=require("openai");var Vt={id:"dall-e-operation",handler:async({text:e,api_key:t,amount:r=1,size:n="1024x1024",save_assets:a=!0},{services:o,database:s,getSchema:i})=>{const{FilesService:l,SettingsService:u}=o,c=await i(),d=new u({schema:c,knex:s}),h=new l({schema:c,knex:s}),f=new Ht({apiKey:await Ut(d,Wt.field,t)}),p=await f.images.generate({prompt:e,n:r,size:n});let m=[],y=[];for(let e=0;e<r;e++){const t=p.data[e].url;if(m.push(t),a){const e=await h.importOne(t);y.push(e)}}return 1===r?{url:m[0],id:y[0]??null}:{url:m,id:y}}};var Kt,Yt={exports:{}};if(!globalThis.ReadableStream)try{const e=require("node:process"),{emitWarning:t}=e;try{e.emitWarning=()=>{},Object.assign(globalThis,require("node:stream/web")),e.emitWarning=t}catch(r){throw e.emitWarning=t,r}}catch(e){Object.assign(globalThis,(Kt||(Kt=1,function(e){const t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol:e=>`Symbol(${e})`;function r(){}function n(){return"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==d?d:void 0}const a=n();function o(e){return"object"==typeof e&&null!==e||"function"==typeof e}const s=r,i=Promise,l=Promise.prototype.then,u=Promise.resolve.bind(i),c=Promise.reject.bind(i);function h(e){return new i(e)}function f(e){return u(e)}function p(e){return c(e)}function m(e,t,r){return l.call(e,t,r)}function y(e,t,r){m(m(e,t,r),void 0,s)}function _(e,t){y(e,t)}function g(e,t){y(e,void 0,t)}function b(e,t,r){return m(e,t,r)}function v(e){m(e,void 0,s)}const w=(()=>{const e=a&&a.queueMicrotask;if("function"==typeof e)return e;const t=f(void 0);return e=>m(t,e)})();function S(e,t,r){if("function"!=typeof e)throw new TypeError("Argument is not a function");return Function.prototype.apply.call(e,t,r)}function T(e,t,r){try{return f(S(e,t,r))}catch(e){return p(e)}}const k=16384;class E{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(e){const t=this._back;let r=t;t._elements.length===k-1&&(r={_elements:[],_next:void 0}),t._elements.push(e),r!==t&&(this._back=r,t._next=r),++this._size}shift(){const e=this._front;let t=e;const r=this._cursor;let n=r+1;const a=e._elements,o=a[r];return n===k&&(t=e._next,n=0),--this._size,this._cursor=n,e!==t&&(this._front=t),a[r]=void 0,o}forEach(e){let t=this._cursor,r=this._front,n=r._elements;for(;!(t===n.length&&void 0===r._next||t===n.length&&(r=r._next,n=r._elements,t=0,0===n.length));)e(n[t]),++t}peek(){const e=this._front,t=this._cursor;return e._elements[t]}}function R(e,t){e._ownerReadableStream=t,t._reader=e,"readable"===t._state?A(e):"closed"===t._state?j(e):O(e,t._storedError)}function x(e,t){return En(e._ownerReadableStream,t)}function P(e){"readable"===e._ownerReadableStream._state?q(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):I(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),e._ownerReadableStream._reader=void 0,e._ownerReadableStream=void 0}function C(e){return new TypeError("Cannot "+e+" a stream using a released reader")}function A(e){e._closedPromise=h(((t,r)=>{e._closedPromise_resolve=t,e._closedPromise_reject=r}))}function O(e,t){A(e),q(e,t)}function j(e){A(e),L(e)}function q(e,t){void 0!==e._closedPromise_reject&&(v(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}function I(e,t){O(e,t)}function L(e){void 0!==e._closedPromise_resolve&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}const $=t("[[AbortSteps]]"),Z=t("[[ErrorSteps]]"),N=t("[[CancelSteps]]"),B=t("[[PullSteps]]"),z=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)},D=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};function M(e){return"object"==typeof e||"function"==typeof e}function W(e,t){if(void 0!==e&&!M(e))throw new TypeError(`${t} is not an object.`)}function F(e,t){if("function"!=typeof e)throw new TypeError(`${t} is not a function.`)}function U(e){return"object"==typeof e&&null!==e||"function"==typeof e}function H(e,t){if(!U(e))throw new TypeError(`${t} is not an object.`)}function V(e,t,r){if(void 0===e)throw new TypeError(`Parameter ${t} is required in '${r}'.`)}function K(e,t,r){if(void 0===e)throw new TypeError(`${t} is required in '${r}'.`)}function Y(e){return Number(e)}function G(e){return 0===e?0:e}function Q(e){return G(D(e))}function J(e,t){const r=0,n=Number.MAX_SAFE_INTEGER;let a=Number(e);if(a=G(a),!z(a))throw new TypeError(`${t} is not a finite number`);if(a=Q(a),a<r||a>n)throw new TypeError(`${t} is outside the accepted range of ${r} to ${n}, inclusive`);return z(a)&&0!==a?a:0}function X(e,t){if(!Tn(e))throw new TypeError(`${t} is not a ReadableStream.`)}function ee(e){return new oe(e)}function te(e,t){e._reader._readRequests.push(t)}function re(e,t,r){const n=e._reader._readRequests.shift();r?n._closeSteps():n._chunkSteps(t)}function ne(e){return e._reader._readRequests.length}function ae(e){const t=e._reader;return void 0!==t&&!!se(t)}class oe{constructor(e){if(V(e,1,"ReadableStreamDefaultReader"),X(e,"First parameter"),kn(e))throw new TypeError("This stream has already been locked for exclusive reading by another reader");R(this,e),this._readRequests=new E}get closed(){return se(this)?this._closedPromise:p(le("closed"))}cancel(e=void 0){return se(this)?void 0===this._ownerReadableStream?p(C("cancel")):x(this,e):p(le("cancel"))}read(){if(!se(this))return p(le("read"));if(void 0===this._ownerReadableStream)return p(C("read from"));let e,t;const r=h(((r,n)=>{e=r,t=n})),n={_chunkSteps:t=>e({value:t,done:!1}),_closeSteps:()=>e({value:void 0,done:!0}),_errorSteps:e=>t(e)};return ie(this,n),r}releaseLock(){if(!se(this))throw le("releaseLock");if(void 0!==this._ownerReadableStream){if(this._readRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");P(this)}}}function se(e){return!!o(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readRequests")&&e instanceof oe}function ie(e,t){const r=e._ownerReadableStream;r._disturbed=!0,"closed"===r._state?t._closeSteps():"errored"===r._state?t._errorSteps(r._storedError):r._readableStreamController[B](t)}function le(e){return new TypeError(`ReadableStreamDefaultReader.prototype.${e} can only be used on a ReadableStreamDefaultReader`)}Object.defineProperties(oe.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(oe.prototype,t.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});const ue=Object.getPrototypeOf(Object.getPrototypeOf((async function*(){})).prototype);class ce{constructor(e,t){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=e,this._preventCancel=t}next(){const e=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?b(this._ongoingPromise,e,e):e(),this._ongoingPromise}return(e){const t=()=>this._returnSteps(e);return this._ongoingPromise?b(this._ongoingPromise,t,t):t()}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});const e=this._reader;if(void 0===e._ownerReadableStream)return p(C("iterate"));let t,r;const n=h(((e,n)=>{t=e,r=n}));return ie(e,{_chunkSteps:e=>{this._ongoingPromise=void 0,w((()=>t({value:e,done:!1})))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,P(e),t({value:void 0,done:!0})},_errorSteps:t=>{this._ongoingPromise=void 0,this._isFinished=!0,P(e),r(t)}}),n}_returnSteps(e){if(this._isFinished)return Promise.resolve({value:e,done:!0});this._isFinished=!0;const t=this._reader;if(void 0===t._ownerReadableStream)return p(C("finish iterating"));if(!this._preventCancel){const r=x(t,e);return P(t),b(r,(()=>({value:e,done:!0})))}return P(t),f({value:e,done:!0})}}const de={next(){return fe(this)?this._asyncIteratorImpl.next():p(pe("next"))},return(e){return fe(this)?this._asyncIteratorImpl.return(e):p(pe("return"))}};function he(e,t){const r=ee(e),n=new ce(r,t),a=Object.create(de);return a._asyncIteratorImpl=n,a}function fe(e){if(!o(e))return!1;if(!Object.prototype.hasOwnProperty.call(e,"_asyncIteratorImpl"))return!1;try{return e._asyncIteratorImpl instanceof ce}catch(e){return!1}}function pe(e){return new TypeError(`ReadableStreamAsyncIterator.${e} can only be used on a ReadableSteamAsyncIterator`)}void 0!==ue&&Object.setPrototypeOf(de,ue);const me=Number.isNaN||function(e){return e!=e};function ye(e){return e.slice()}function _e(e,t,r,n,a){new Uint8Array(e).set(new Uint8Array(r,n,a),t)}function ge(e){return e}function be(e){return!1}function ve(e,t,r){if(e.slice)return e.slice(t,r);const n=r-t,a=new ArrayBuffer(n);return _e(a,0,e,t,n),a}function we(e){return!("number"!=typeof e||me(e)||e<0)}function Se(e){const t=ve(e.buffer,e.byteOffset,e.byteOffset+e.byteLength);return new Uint8Array(t)}function Te(e){const t=e._queue.shift();return e._queueTotalSize-=t.size,e._queueTotalSize<0&&(e._queueTotalSize=0),t.value}function ke(e,t,r){if(!we(r)||r===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");e._queue.push({value:t,size:r}),e._queueTotalSize+=r}function Ee(e){return e._queue.peek().value}function Re(e){e._queue=new E,e._queueTotalSize=0}class xe{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!Ae(this))throw at("view");return this._view}respond(e){if(!Ae(this))throw at("respond");if(V(e,1,"respond"),e=J(e,"First parameter"),void 0===this._associatedReadableByteStreamController)throw new TypeError("This BYOB request has been invalidated");be(this._view.buffer),Xe(this._associatedReadableByteStreamController,e)}respondWithNewView(e){if(!Ae(this))throw at("respondWithNewView");if(V(e,1,"respondWithNewView"),!ArrayBuffer.isView(e))throw new TypeError("You can only respond with array buffer views");if(void 0===this._associatedReadableByteStreamController)throw new TypeError("This BYOB request has been invalidated");be(e.buffer),et(this._associatedReadableByteStreamController,e)}}Object.defineProperties(xe.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(xe.prototype,t.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class Pe{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!Ce(this))throw ot("byobRequest");return Qe(this)}get desiredSize(){if(!Ce(this))throw ot("desiredSize");return Je(this)}close(){if(!Ce(this))throw ot("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");const e=this._controlledReadableByteStream._state;if("readable"!==e)throw new TypeError(`The stream (in ${e} state) is not in the readable state and cannot be closed`);Ke(this)}enqueue(e){if(!Ce(this))throw ot("enqueue");if(V(e,1,"enqueue"),!ArrayBuffer.isView(e))throw new TypeError("chunk must be an array buffer view");if(0===e.byteLength)throw new TypeError("chunk must have non-zero byteLength");if(0===e.buffer.byteLength)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");const t=this._controlledReadableByteStream._state;if("readable"!==t)throw new TypeError(`The stream (in ${t} state) is not in the readable state and cannot be enqueued to`);Ye(this,e)}error(e=void 0){if(!Ce(this))throw ot("error");Ge(this,e)}[N](e){je(this),Re(this);const t=this._cancelAlgorithm(e);return Ve(this),t}[B](e){const t=this._controlledReadableByteStream;if(this._queueTotalSize>0){const t=this._queue.shift();this._queueTotalSize-=t.byteLength,Ne(this);const r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);return void e._chunkSteps(r)}const r=this._autoAllocateChunkSize;if(void 0!==r){let t;try{t=new ArrayBuffer(r)}catch(t){return void e._errorSteps(t)}const n={buffer:t,bufferByteLength:r,byteOffset:0,byteLength:r,bytesFilled:0,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(n)}te(t,e),Oe(this)}}function Ce(e){return!!o(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledReadableByteStream")&&e instanceof Pe}function Ae(e){return!!o(e)&&!!Object.prototype.hasOwnProperty.call(e,"_associatedReadableByteStreamController")&&e instanceof xe}function Oe(e){He(e)&&(e._pulling?e._pullAgain=!0:(e._pulling=!0,y(e._pullAlgorithm(),(()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,Oe(e))}),(t=>{Ge(e,t)}))))}function je(e){Be(e),e._pendingPullIntos=new E}function qe(e,t){let r=!1;"closed"===e._state&&(r=!0);const n=Ie(t);"default"===t.readerType?re(e,n,r):lt(e,n,r)}function Ie(e){const t=e.bytesFilled,r=e.elementSize;return new e.viewConstructor(e.buffer,e.byteOffset,t/r)}function Le(e,t,r,n){e._queue.push({buffer:t,byteOffset:r,byteLength:n}),e._queueTotalSize+=n}function $e(e,t){const r=t.elementSize,n=t.bytesFilled-t.bytesFilled%r,a=Math.min(e._queueTotalSize,t.byteLength-t.bytesFilled),o=t.bytesFilled+a,s=o-o%r;let i=a,l=!1;s>n&&(i=s-t.bytesFilled,l=!0);const u=e._queue;for(;i>0;){const r=u.peek(),n=Math.min(i,r.byteLength),a=t.byteOffset+t.bytesFilled;_e(t.buffer,a,r.buffer,r.byteOffset,n),r.byteLength===n?u.shift():(r.byteOffset+=n,r.byteLength-=n),e._queueTotalSize-=n,Ze(e,n,t),i-=n}return l}function Ze(e,t,r){r.bytesFilled+=t}function Ne(e){0===e._queueTotalSize&&e._closeRequested?(Ve(e),Rn(e._controlledReadableByteStream)):Oe(e)}function Be(e){null!==e._byobRequest&&(e._byobRequest._associatedReadableByteStreamController=void 0,e._byobRequest._view=null,e._byobRequest=null)}function ze(e){for(;e._pendingPullIntos.length>0;){if(0===e._queueTotalSize)return;const t=e._pendingPullIntos.peek();$e(e,t)&&(Ue(e),qe(e._controlledReadableByteStream,t))}}function De(e,t,r){const n=e._controlledReadableByteStream;let a=1;t.constructor!==DataView&&(a=t.constructor.BYTES_PER_ELEMENT);const o=t.constructor,s=ge(t.buffer),i={buffer:s,bufferByteLength:s.byteLength,byteOffset:t.byteOffset,byteLength:t.byteLength,bytesFilled:0,elementSize:a,viewConstructor:o,readerType:"byob"};if(e._pendingPullIntos.length>0)return e._pendingPullIntos.push(i),void it(n,r);if("closed"!==n._state){if(e._queueTotalSize>0){if($e(e,i)){const t=Ie(i);return Ne(e),void r._chunkSteps(t)}if(e._closeRequested){const t=new TypeError("Insufficient bytes to fill elements in the given buffer");return Ge(e,t),void r._errorSteps(t)}}e._pendingPullIntos.push(i),it(n,r),Oe(e)}else{const e=new o(i.buffer,i.byteOffset,0);r._closeSteps(e)}}function Me(e,t){const r=e._controlledReadableByteStream;if(ct(r))for(;ut(r)>0;)qe(r,Ue(e))}function We(e,t,r){if(Ze(e,t,r),r.bytesFilled<r.elementSize)return;Ue(e);const n=r.bytesFilled%r.elementSize;if(n>0){const t=r.byteOffset+r.bytesFilled,a=ve(r.buffer,t-n,t);Le(e,a,0,a.byteLength)}r.bytesFilled-=n,qe(e._controlledReadableByteStream,r),ze(e)}function Fe(e,t){const r=e._pendingPullIntos.peek();Be(e),"closed"===e._controlledReadableByteStream._state?Me(e):We(e,t,r),Oe(e)}function Ue(e){return e._pendingPullIntos.shift()}function He(e){const t=e._controlledReadableByteStream;return"readable"===t._state&&!e._closeRequested&&!!e._started&&(!!(ae(t)&&ne(t)>0)||!!(ct(t)&&ut(t)>0)||Je(e)>0)}function Ve(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0}function Ke(e){const t=e._controlledReadableByteStream;if(!e._closeRequested&&"readable"===t._state)if(e._queueTotalSize>0)e._closeRequested=!0;else{if(e._pendingPullIntos.length>0&&e._pendingPullIntos.peek().bytesFilled>0){const t=new TypeError("Insufficient bytes to fill elements in the given buffer");throw Ge(e,t),t}Ve(e),Rn(t)}}function Ye(e,t){const r=e._controlledReadableByteStream;if(e._closeRequested||"readable"!==r._state)return;const n=t.buffer,a=t.byteOffset,o=t.byteLength,s=ge(n);if(e._pendingPullIntos.length>0){const t=e._pendingPullIntos.peek();be(t.buffer),t.buffer=ge(t.buffer)}Be(e),ae(r)?0===ne(r)?Le(e,s,a,o):(e._pendingPullIntos.length>0&&Ue(e),re(r,new Uint8Array(s,a,o),!1)):ct(r)?(Le(e,s,a,o),ze(e)):Le(e,s,a,o),Oe(e)}function Ge(e,t){const r=e._controlledReadableByteStream;"readable"===r._state&&(je(e),Re(e),Ve(e),xn(r,t))}function Qe(e){if(null===e._byobRequest&&e._pendingPullIntos.length>0){const t=e._pendingPullIntos.peek(),r=new Uint8Array(t.buffer,t.byteOffset+t.bytesFilled,t.byteLength-t.bytesFilled),n=Object.create(xe.prototype);nt(n,e,r),e._byobRequest=n}return e._byobRequest}function Je(e){const t=e._controlledReadableByteStream._state;return"errored"===t?null:"closed"===t?0:e._strategyHWM-e._queueTotalSize}function Xe(e,t){const r=e._pendingPullIntos.peek();if("closed"===e._controlledReadableByteStream._state){if(0!==t)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(0===t)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(r.bytesFilled+t>r.byteLength)throw new RangeError("bytesWritten out of range")}r.buffer=ge(r.buffer),Fe(e,t)}function et(e,t){const r=e._pendingPullIntos.peek();if("closed"===e._controlledReadableByteStream._state){if(0!==t.byteLength)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(0===t.byteLength)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(r.byteOffset+r.bytesFilled!==t.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(r.bufferByteLength!==t.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(r.bytesFilled+t.byteLength>r.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");const n=t.byteLength;r.buffer=ge(t.buffer),Fe(e,n)}function tt(e,t,r,n,a,o,s){t._controlledReadableByteStream=e,t._pullAgain=!1,t._pulling=!1,t._byobRequest=null,t._queue=t._queueTotalSize=void 0,Re(t),t._closeRequested=!1,t._started=!1,t._strategyHWM=o,t._pullAlgorithm=n,t._cancelAlgorithm=a,t._autoAllocateChunkSize=s,t._pendingPullIntos=new E,e._readableStreamController=t,y(f(r()),(()=>{t._started=!0,Oe(t)}),(e=>{Ge(t,e)}))}function rt(e,t,r){const n=Object.create(Pe.prototype);let a=()=>{},o=()=>f(void 0),s=()=>f(void 0);void 0!==t.start&&(a=()=>t.start(n)),void 0!==t.pull&&(o=()=>t.pull(n)),void 0!==t.cancel&&(s=e=>t.cancel(e));const i=t.autoAllocateChunkSize;if(0===i)throw new TypeError("autoAllocateChunkSize must be greater than 0");tt(e,n,a,o,s,r,i)}function nt(e,t,r){e._associatedReadableByteStreamController=t,e._view=r}function at(e){return new TypeError(`ReadableStreamBYOBRequest.prototype.${e} can only be used on a ReadableStreamBYOBRequest`)}function ot(e){return new TypeError(`ReadableByteStreamController.prototype.${e} can only be used on a ReadableByteStreamController`)}function st(e){return new dt(e)}function it(e,t){e._reader._readIntoRequests.push(t)}function lt(e,t,r){const n=e._reader._readIntoRequests.shift();r?n._closeSteps(t):n._chunkSteps(t)}function ut(e){return e._reader._readIntoRequests.length}function ct(e){const t=e._reader;return void 0!==t&&!!ht(t)}Object.defineProperties(Pe.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(Pe.prototype,t.toStringTag,{value:"ReadableByteStreamController",configurable:!0});class dt{constructor(e){if(V(e,1,"ReadableStreamBYOBReader"),X(e,"First parameter"),kn(e))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!Ce(e._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");R(this,e),this._readIntoRequests=new E}get closed(){return ht(this)?this._closedPromise:p(pt("closed"))}cancel(e=void 0){return ht(this)?void 0===this._ownerReadableStream?p(C("cancel")):x(this,e):p(pt("cancel"))}read(e){if(!ht(this))return p(pt("read"));if(!ArrayBuffer.isView(e))return p(new TypeError("view must be an array buffer view"));if(0===e.byteLength)return p(new TypeError("view must have non-zero byteLength"));if(0===e.buffer.byteLength)return p(new TypeError("view's buffer must have non-zero byteLength"));if(be(e.buffer),void 0===this._ownerReadableStream)return p(C("read from"));let t,r;const n=h(((e,n)=>{t=e,r=n})),a={_chunkSteps:e=>t({value:e,done:!1}),_closeSteps:e=>t({value:e,done:!0}),_errorSteps:e=>r(e)};return ft(this,e,a),n}releaseLock(){if(!ht(this))throw pt("releaseLock");if(void 0!==this._ownerReadableStream){if(this._readIntoRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");P(this)}}}function ht(e){return!!o(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readIntoRequests")&&e instanceof dt}function ft(e,t,r){const n=e._ownerReadableStream;n._disturbed=!0,"errored"===n._state?r._errorSteps(n._storedError):De(n._readableStreamController,t,r)}function pt(e){return new TypeError(`ReadableStreamBYOBReader.prototype.${e} can only be used on a ReadableStreamBYOBReader`)}function mt(e,t){const{highWaterMark:r}=e;if(void 0===r)return t;if(me(r)||r<0)throw new RangeError("Invalid highWaterMark");return r}function yt(e){const{size:t}=e;return t||(()=>1)}function _t(e,t){W(e,t);const r=null==e?void 0:e.highWaterMark,n=null==e?void 0:e.size;return{highWaterMark:void 0===r?void 0:Y(r),size:void 0===n?void 0:gt(n,`${t} has member 'size' that`)}}function gt(e,t){return F(e,t),t=>Y(e(t))}function bt(e,t){W(e,t);const r=null==e?void 0:e.abort,n=null==e?void 0:e.close,a=null==e?void 0:e.start,o=null==e?void 0:e.type,s=null==e?void 0:e.write;return{abort:void 0===r?void 0:vt(r,e,`${t} has member 'abort' that`),close:void 0===n?void 0:wt(n,e,`${t} has member 'close' that`),start:void 0===a?void 0:St(a,e,`${t} has member 'start' that`),write:void 0===s?void 0:Tt(s,e,`${t} has member 'write' that`),type:o}}function vt(e,t,r){return F(e,r),r=>T(e,t,[r])}function wt(e,t,r){return F(e,r),()=>T(e,t,[])}function St(e,t,r){return F(e,r),r=>S(e,t,[r])}function Tt(e,t,r){return F(e,r),(r,n)=>T(e,t,[r,n])}function kt(e,t){if(!jt(e))throw new TypeError(`${t} is not a WritableStream.`)}function Et(e){if("object"!=typeof e||null===e)return!1;try{return"boolean"==typeof e.aborted}catch(e){return!1}}Object.defineProperties(dt.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(dt.prototype,t.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});const Rt="function"==typeof AbortController;function xt(){if(Rt)return new AbortController}class Pt{constructor(e={},t={}){void 0===e?e=null:H(e,"First parameter");const r=_t(t,"Second parameter"),n=bt(e,"First parameter");if(Ot(this),void 0!==n.type)throw new RangeError("Invalid type is specified");const a=yt(r);cr(this,n,mt(r,1),a)}get locked(){if(!jt(this))throw Sr("locked");return qt(this)}abort(e=void 0){return jt(this)?qt(this)?p(new TypeError("Cannot abort a stream that already has a writer")):It(this,e):p(Sr("abort"))}close(){return jt(this)?qt(this)?p(new TypeError("Cannot close a stream that already has a writer")):Ft(this)?p(new TypeError("Cannot close an already-closing stream")):Lt(this):p(Sr("close"))}getWriter(){if(!jt(this))throw Sr("getWriter");return Ct(this)}}function Ct(e){return new Gt(e)}function At(e,t,r,n,a=1,o=()=>1){const s=Object.create(Pt.prototype);return Ot(s),ur(s,Object.create(ir.prototype),e,t,r,n,a,o),s}function Ot(e){e._state="writable",e._storedError=void 0,e._writer=void 0,e._writableStreamController=void 0,e._writeRequests=new E,e._inFlightWriteRequest=void 0,e._closeRequest=void 0,e._inFlightCloseRequest=void 0,e._pendingAbortRequest=void 0,e._backpressure=!1}function jt(e){return!!o(e)&&!!Object.prototype.hasOwnProperty.call(e,"_writableStreamController")&&e instanceof Pt}function qt(e){return void 0!==e._writer}function It(e,t){var r;if("closed"===e._state||"errored"===e._state)return f(void 0);e._writableStreamController._abortReason=t,null===(r=e._writableStreamController._abortController)||void 0===r||r.abort();const n=e._state;if("closed"===n||"errored"===n)return f(void 0);if(void 0!==e._pendingAbortRequest)return e._pendingAbortRequest._promise;let a=!1;"erroring"===n&&(a=!0,t=void 0);const o=h(((r,n)=>{e._pendingAbortRequest={_promise:void 0,_resolve:r,_reject:n,_reason:t,_wasAlreadyErroring:a}}));return e._pendingAbortRequest._promise=o,a||Nt(e,t),o}function Lt(e){const t=e._state;if("closed"===t||"errored"===t)return p(new TypeError(`The stream (in ${t} state) is not in the writable state and cannot be closed`));const r=h(((t,r)=>{const n={_resolve:t,_reject:r};e._closeRequest=n})),n=e._writer;return void 0!==n&&e._backpressure&&"writable"===t&&Nr(n),hr(e._writableStreamController),r}function $t(e){return h(((t,r)=>{const n={_resolve:t,_reject:r};e._writeRequests.push(n)}))}function Zt(e,t){"writable"!==e._state?Bt(e):Nt(e,t)}function Nt(e,t){const r=e._writableStreamController;e._state="erroring",e._storedError=t;const n=e._writer;void 0!==n&&rr(n,t),!Ut(e)&&r._started&&Bt(e)}function Bt(e){e._state="errored",e._writableStreamController[Z]();const t=e._storedError;if(e._writeRequests.forEach((e=>{e._reject(t)})),e._writeRequests=new E,void 0===e._pendingAbortRequest)return void Kt(e);const r=e._pendingAbortRequest;if(e._pendingAbortRequest=void 0,r._wasAlreadyErroring)return r._reject(t),void Kt(e);y(e._writableStreamController[$](r._reason),(()=>{r._resolve(),Kt(e)}),(t=>{r._reject(t),Kt(e)}))}function zt(e){e._inFlightWriteRequest._resolve(void 0),e._inFlightWriteRequest=void 0}function Dt(e,t){e._inFlightWriteRequest._reject(t),e._inFlightWriteRequest=void 0,Zt(e,t)}function Mt(e){e._inFlightCloseRequest._resolve(void 0),e._inFlightCloseRequest=void 0,"erroring"===e._state&&(e._storedError=void 0,void 0!==e._pendingAbortRequest&&(e._pendingAbortRequest._resolve(),e._pendingAbortRequest=void 0)),e._state="closed";const t=e._writer;void 0!==t&&Or(t)}function Wt(e,t){e._inFlightCloseRequest._reject(t),e._inFlightCloseRequest=void 0,void 0!==e._pendingAbortRequest&&(e._pendingAbortRequest._reject(t),e._pendingAbortRequest=void 0),Zt(e,t)}function Ft(e){return void 0!==e._closeRequest||void 0!==e._inFlightCloseRequest}function Ut(e){return void 0!==e._inFlightWriteRequest||void 0!==e._inFlightCloseRequest}function Ht(e){e._inFlightCloseRequest=e._closeRequest,e._closeRequest=void 0}function Vt(e){e._inFlightWriteRequest=e._writeRequests.shift()}function Kt(e){void 0!==e._closeRequest&&(e._closeRequest._reject(e._storedError),e._closeRequest=void 0);const t=e._writer;void 0!==t&&Cr(t,e._storedError)}function Yt(e,t){const r=e._writer;void 0!==r&&t!==e._backpressure&&(t?$r(r):Nr(r)),e._backpressure=t}Object.defineProperties(Pt.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(Pt.prototype,t.toStringTag,{value:"WritableStream",configurable:!0});class Gt{constructor(e){if(V(e,1,"WritableStreamDefaultWriter"),kt(e,"First parameter"),qt(e))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=e,e._writer=this;const t=e._state;if("writable"===t)!Ft(e)&&e._backpressure?jr(this):Ir(this),Rr(this);else if("erroring"===t)qr(this,e._storedError),Rr(this);else if("closed"===t)Ir(this),Pr(this);else{const t=e._storedError;qr(this,t),xr(this,t)}}get closed(){return Qt(this)?this._closedPromise:p(kr("closed"))}get desiredSize(){if(!Qt(this))throw kr("desiredSize");if(void 0===this._ownerWritableStream)throw Er("desiredSize");return nr(this)}get ready(){return Qt(this)?this._readyPromise:p(kr("ready"))}abort(e=void 0){return Qt(this)?void 0===this._ownerWritableStream?p(Er("abort")):Jt(this,e):p(kr("abort"))}close(){if(!Qt(this))return p(kr("close"));const e=this._ownerWritableStream;return void 0===e?p(Er("close")):Ft(e)?p(new TypeError("Cannot close an already-closing stream")):Xt(this)}releaseLock(){if(!Qt(this))throw kr("releaseLock");void 0!==this._ownerWritableStream&&ar(this)}write(e=void 0){return Qt(this)?void 0===this._ownerWritableStream?p(Er("write to")):or(this,e):p(kr("write"))}}function Qt(e){return!!o(e)&&!!Object.prototype.hasOwnProperty.call(e,"_ownerWritableStream")&&e instanceof Gt}function Jt(e,t){return It(e._ownerWritableStream,t)}function Xt(e){return Lt(e._ownerWritableStream)}function er(e){const t=e._ownerWritableStream,r=t._state;return Ft(t)||"closed"===r?f(void 0):"errored"===r?p(t._storedError):Xt(e)}function tr(e,t){"pending"===e._closedPromiseState?Cr(e,t):Ar(e,t)}function rr(e,t){"pending"===e._readyPromiseState?Lr(e,t):Zr(e,t)}function nr(e){const t=e._ownerWritableStream,r=t._state;return"errored"===r||"erroring"===r?null:"closed"===r?0:pr(t._writableStreamController)}function ar(e){const t=e._ownerWritableStream,r=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");rr(e,r),tr(e,r),t._writer=void 0,e._ownerWritableStream=void 0}function or(e,t){const r=e._ownerWritableStream,n=r._writableStreamController,a=fr(n,t);if(r!==e._ownerWritableStream)return p(Er("write to"));const o=r._state;if("errored"===o)return p(r._storedError);if(Ft(r)||"closed"===o)return p(new TypeError("The stream is closing or closed and cannot be written to"));if("erroring"===o)return p(r._storedError);const s=$t(r);return mr(n,t,a),s}Object.defineProperties(Gt.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(Gt.prototype,t.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});const sr={};class ir{constructor(){throw new TypeError("Illegal constructor")}get abortReason(){if(!lr(this))throw Tr("abortReason");return this._abortReason}get signal(){if(!lr(this))throw Tr("signal");if(void 0===this._abortController)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(e=void 0){if(!lr(this))throw Tr("error");"writable"===this._controlledWritableStream._state&&wr(this,e)}[$](e){const t=this._abortAlgorithm(e);return dr(this),t}[Z](){Re(this)}}function lr(e){return!!o(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledWritableStream")&&e instanceof ir}function ur(e,t,r,n,a,o,s,i){t._controlledWritableStream=e,e._writableStreamController=t,t._queue=void 0,t._queueTotalSize=void 0,Re(t),t._abortReason=void 0,t._abortController=xt(),t._started=!1,t._strategySizeAlgorithm=i,t._strategyHWM=s,t._writeAlgorithm=n,t._closeAlgorithm=a,t._abortAlgorithm=o;const l=vr(t);Yt(e,l),y(f(r()),(()=>{t._started=!0,yr(t)}),(r=>{t._started=!0,Zt(e,r)}))}function cr(e,t,r,n){const a=Object.create(ir.prototype);let o=()=>{},s=()=>f(void 0),i=()=>f(void 0),l=()=>f(void 0);void 0!==t.start&&(o=()=>t.start(a)),void 0!==t.write&&(s=e=>t.write(e,a)),void 0!==t.close&&(i=()=>t.close()),void 0!==t.abort&&(l=e=>t.abort(e)),ur(e,a,o,s,i,l,r,n)}function dr(e){e._writeAlgorithm=void 0,e._closeAlgorithm=void 0,e._abortAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function hr(e){ke(e,sr,0),yr(e)}function fr(e,t){try{return e._strategySizeAlgorithm(t)}catch(t){return _r(e,t),1}}function pr(e){return e._strategyHWM-e._queueTotalSize}function mr(e,t,r){try{ke(e,t,r)}catch(t){return void _r(e,t)}const n=e._controlledWritableStream;Ft(n)||"writable"!==n._state||Yt(n,vr(e)),yr(e)}function yr(e){const t=e._controlledWritableStream;if(!e._started)return;if(void 0!==t._inFlightWriteRequest)return;if("erroring"===t._state)return void Bt(t);if(0===e._queue.length)return;const r=Ee(e);r===sr?gr(e):br(e,r)}function _r(e,t){"writable"===e._controlledWritableStream._state&&wr(e,t)}function gr(e){const t=e._controlledWritableStream;Ht(t),Te(e);const r=e._closeAlgorithm();dr(e),y(r,(()=>{Mt(t)}),(e=>{Wt(t,e)}))}function br(e,t){const r=e._controlledWritableStream;Vt(r),y(e._writeAlgorithm(t),(()=>{zt(r);const t=r._state;if(Te(e),!Ft(r)&&"writable"===t){const t=vr(e);Yt(r,t)}yr(e)}),(t=>{"writable"===r._state&&dr(e),Dt(r,t)}))}function vr(e){return pr(e)<=0}function wr(e,t){const r=e._controlledWritableStream;dr(e),Nt(r,t)}function Sr(e){return new TypeError(`WritableStream.prototype.${e} can only be used on a WritableStream`)}function Tr(e){return new TypeError(`WritableStreamDefaultController.prototype.${e} can only be used on a WritableStreamDefaultController`)}function kr(e){return new TypeError(`WritableStreamDefaultWriter.prototype.${e} can only be used on a WritableStreamDefaultWriter`)}function Er(e){return new TypeError("Cannot "+e+" a stream using a released writer")}function Rr(e){e._closedPromise=h(((t,r)=>{e._closedPromise_resolve=t,e._closedPromise_reject=r,e._closedPromiseState="pending"}))}function xr(e,t){Rr(e),Cr(e,t)}function Pr(e){Rr(e),Or(e)}function Cr(e,t){void 0!==e._closedPromise_reject&&(v(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected")}function Ar(e,t){xr(e,t)}function Or(e){void 0!==e._closedPromise_resolve&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved")}function jr(e){e._readyPromise=h(((t,r)=>{e._readyPromise_resolve=t,e._readyPromise_reject=r})),e._readyPromiseState="pending"}function qr(e,t){jr(e),Lr(e,t)}function Ir(e){jr(e),Nr(e)}function Lr(e,t){void 0!==e._readyPromise_reject&&(v(e._readyPromise),e._readyPromise_reject(t),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected")}function $r(e){jr(e)}function Zr(e,t){qr(e,t)}function Nr(e){void 0!==e._readyPromise_resolve&&(e._readyPromise_resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled")}Object.defineProperties(ir.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(ir.prototype,t.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});const Br="undefined"!=typeof DOMException?DOMException:void 0;function zr(e){if("function"!=typeof e&&"object"!=typeof e)return!1;try{return new e,!0}catch(e){return!1}}function Dr(){const e=function(e,t){this.message=e||"",this.name=t||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return e.prototype=Object.create(Error.prototype),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,configurable:!0}),e}const Mr=zr(Br)?Br:Dr();function Wr(e,t,n,a,o,s){const i=ee(e),l=Ct(t);e._disturbed=!0;let u=!1,c=f(void 0);return h(((d,p)=>{let b;if(void 0!==s){if(b=()=>{const r=new Mr("Aborted","AbortError"),n=[];a||n.push((()=>"writable"===t._state?It(t,r):f(void 0))),o||n.push((()=>"readable"===e._state?En(e,r):f(void 0))),R((()=>Promise.all(n.map((e=>e())))),!0,r)},s.aborted)return void b();s.addEventListener("abort",b)}function w(){return h(((e,t)=>{function r(n){n?e():m(S(),r,t)}r(!1)}))}function S(){return u?f(!0):m(l._readyPromise,(()=>h(((e,t)=>{ie(i,{_chunkSteps:t=>{c=m(or(l,t),void 0,r),e(!1)},_closeSteps:()=>e(!0),_errorSteps:t})}))))}if(k(e,i._closedPromise,(e=>{a?x(!0,e):R((()=>It(t,e)),!0,e)})),k(t,l._closedPromise,(t=>{o?x(!0,t):R((()=>En(e,t)),!0,t)})),E(e,i._closedPromise,(()=>{n?x():R((()=>er(l)))})),Ft(t)||"closed"===t._state){const t=new TypeError("the destination writable stream closed before all data could be piped to it");o?x(!0,t):R((()=>En(e,t)),!0,t)}function T(){const e=c;return m(c,(()=>e!==c?T():void 0))}function k(e,t,r){"errored"===e._state?r(e._storedError):g(t,r)}function E(e,t,r){"closed"===e._state?r():_(t,r)}function R(e,r,n){function a(){y(e(),(()=>C(r,n)),(e=>C(!0,e)))}u||(u=!0,"writable"!==t._state||Ft(t)?a():_(T(),a))}function x(e,r){u||(u=!0,"writable"!==t._state||Ft(t)?C(e,r):_(T(),(()=>C(e,r))))}function C(e,t){ar(l),P(i),void 0!==s&&s.removeEventListener("abort",b),e?p(t):d(void 0)}v(w())}))}class Fr{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Ur(this))throw nn("desiredSize");return Jr(this)}close(){if(!Ur(this))throw nn("close");if(!en(this))throw new TypeError("The stream is not in a state that permits close");Yr(this)}enqueue(e=void 0){if(!Ur(this))throw nn("enqueue");if(!en(this))throw new TypeError("The stream is not in a state that permits enqueue");return Gr(this,e)}error(e=void 0){if(!Ur(this))throw nn("error");Qr(this,e)}[N](e){Re(this);const t=this._cancelAlgorithm(e);return Kr(this),t}[B](e){const t=this._controlledReadableStream;if(this._queue.length>0){const r=Te(this);this._closeRequested&&0===this._queue.length?(Kr(this),Rn(t)):Hr(this),e._chunkSteps(r)}else te(t,e),Hr(this)}}function Ur(e){return!!o(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledReadableStream")&&e instanceof Fr}function Hr(e){Vr(e)&&(e._pulling?e._pullAgain=!0:(e._pulling=!0,y(e._pullAlgorithm(),(()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,Hr(e))}),(t=>{Qr(e,t)}))))}function Vr(e){const t=e._controlledReadableStream;return!!en(e)&&!!e._started&&(!!(kn(t)&&ne(t)>0)||Jr(e)>0)}function Kr(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function Yr(e){if(!en(e))return;const t=e._controlledReadableStream;e._closeRequested=!0,0===e._queue.length&&(Kr(e),Rn(t))}function Gr(e,t){if(!en(e))return;const r=e._controlledReadableStream;if(kn(r)&&ne(r)>0)re(r,t,!1);else{let r;try{r=e._strategySizeAlgorithm(t)}catch(t){throw Qr(e,t),t}try{ke(e,t,r)}catch(t){throw Qr(e,t),t}}Hr(e)}function Qr(e,t){const r=e._controlledReadableStream;"readable"===r._state&&(Re(e),Kr(e),xn(r,t))}function Jr(e){const t=e._controlledReadableStream._state;return"errored"===t?null:"closed"===t?0:e._strategyHWM-e._queueTotalSize}function Xr(e){return!Vr(e)}function en(e){const t=e._controlledReadableStream._state;return!e._closeRequested&&"readable"===t}function tn(e,t,r,n,a,o,s){t._controlledReadableStream=e,t._queue=void 0,t._queueTotalSize=void 0,Re(t),t._started=!1,t._closeRequested=!1,t._pullAgain=!1,t._pulling=!1,t._strategySizeAlgorithm=s,t._strategyHWM=o,t._pullAlgorithm=n,t._cancelAlgorithm=a,e._readableStreamController=t,y(f(r()),(()=>{t._started=!0,Hr(t)}),(e=>{Qr(t,e)}))}function rn(e,t,r,n){const a=Object.create(Fr.prototype);let o=()=>{},s=()=>f(void 0),i=()=>f(void 0);void 0!==t.start&&(o=()=>t.start(a)),void 0!==t.pull&&(s=()=>t.pull(a)),void 0!==t.cancel&&(i=e=>t.cancel(e)),tn(e,a,o,s,i,r,n)}function nn(e){return new TypeError(`ReadableStreamDefaultController.prototype.${e} can only be used on a ReadableStreamDefaultController`)}function an(e,t){return Ce(e._readableStreamController)?sn(e):on(e)}function on(e,t){const r=ee(e);let n,a,o,s,i,l=!1,u=!1,c=!1,d=!1;const p=h((e=>{i=e}));function m(){return l?(u=!0,f(void 0)):(l=!0,ie(r,{_chunkSteps:e=>{w((()=>{u=!1;const t=e,r=e;c||Gr(o._readableStreamController,t),d||Gr(s._readableStreamController,r),l=!1,u&&m()}))},_closeSteps:()=>{l=!1,c||Yr(o._readableStreamController),d||Yr(s._readableStreamController),c&&d||i(void 0)},_errorSteps:()=>{l=!1}}),f(void 0))}function y(t){if(c=!0,n=t,d){const t=ye([n,a]),r=En(e,t);i(r)}return p}function _(t){if(d=!0,a=t,c){const t=ye([n,a]),r=En(e,t);i(r)}return p}function b(){}return o=vn(b,m,y),s=vn(b,m,_),g(r._closedPromise,(e=>{Qr(o._readableStreamController,e),Qr(s._readableStreamController,e),c&&d||i(void 0)})),[o,s]}function sn(e){let t,r,n,a,o,s=ee(e),i=!1,l=!1,u=!1,c=!1,d=!1;const p=h((e=>{o=e}));function m(e){g(e._closedPromise,(t=>{e===s&&(Ge(n._readableStreamController,t),Ge(a._readableStreamController,t),c&&d||o(void 0))}))}function y(){ht(s)&&(P(s),s=ee(e),m(s)),ie(s,{_chunkSteps:t=>{w((()=>{l=!1,u=!1;const r=t;let s=t;if(!c&&!d)try{s=Se(t)}catch(t){return Ge(n._readableStreamController,t),Ge(a._readableStreamController,t),void o(En(e,t))}c||Ye(n._readableStreamController,r),d||Ye(a._readableStreamController,s),i=!1,l?b():u&&v()}))},_closeSteps:()=>{i=!1,c||Ke(n._readableStreamController),d||Ke(a._readableStreamController),n._readableStreamController._pendingPullIntos.length>0&&Xe(n._readableStreamController,0),a._readableStreamController._pendingPullIntos.length>0&&Xe(a._readableStreamController,0),c&&d||o(void 0)},_errorSteps:()=>{i=!1}})}function _(t,r){se(s)&&(P(s),s=st(e),m(s));const h=r?a:n,f=r?n:a;ft(s,t,{_chunkSteps:t=>{w((()=>{l=!1,u=!1;const n=r?d:c;if(r?c:d)n||et(h._readableStreamController,t);else{let r;try{r=Se(t)}catch(t){return Ge(h._readableStreamController,t),Ge(f._readableStreamController,t),void o(En(e,t))}n||et(h._readableStreamController,t),Ye(f._readableStreamController,r)}i=!1,l?b():u&&v()}))},_closeSteps:e=>{i=!1;const t=r?d:c,n=r?c:d;t||Ke(h._readableStreamController),n||Ke(f._readableStreamController),void 0!==e&&(t||et(h._readableStreamController,e),!n&&f._readableStreamController._pendingPullIntos.length>0&&Xe(f._readableStreamController,0)),t&&n||o(void 0)},_errorSteps:()=>{i=!1}})}function b(){if(i)return l=!0,f(void 0);i=!0;const e=Qe(n._readableStreamController);return null===e?y():_(e._view,!1),f(void 0)}function v(){if(i)return u=!0,f(void 0);i=!0;const e=Qe(a._readableStreamController);return null===e?y():_(e._view,!0),f(void 0)}function S(n){if(c=!0,t=n,d){const n=ye([t,r]),a=En(e,n);o(a)}return p}function T(n){if(d=!0,r=n,c){const n=ye([t,r]),a=En(e,n);o(a)}return p}function k(){}return n=wn(k,b,S),a=wn(k,v,T),m(s),[n,a]}function ln(e,t){W(e,t);const r=e,n=null==r?void 0:r.autoAllocateChunkSize,a=null==r?void 0:r.cancel,o=null==r?void 0:r.pull,s=null==r?void 0:r.start,i=null==r?void 0:r.type;return{autoAllocateChunkSize:void 0===n?void 0:J(n,`${t} has member 'autoAllocateChunkSize' that`),cancel:void 0===a?void 0:un(a,r,`${t} has member 'cancel' that`),pull:void 0===o?void 0:cn(o,r,`${t} has member 'pull' that`),start:void 0===s?void 0:dn(s,r,`${t} has member 'start' that`),type:void 0===i?void 0:hn(i,`${t} has member 'type' that`)}}function un(e,t,r){return F(e,r),r=>T(e,t,[r])}function cn(e,t,r){return F(e,r),r=>T(e,t,[r])}function dn(e,t,r){return F(e,r),r=>S(e,t,[r])}function hn(e,t){if("bytes"!=(e=`${e}`))throw new TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamType`);return e}function fn(e,t){W(e,t);const r=null==e?void 0:e.mode;return{mode:void 0===r?void 0:pn(r,`${t} has member 'mode' that`)}}function pn(e,t){if("byob"!=(e=`${e}`))throw new TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamReaderMode`);return e}function mn(e,t){W(e,t);const r=null==e?void 0:e.preventCancel;return{preventCancel:Boolean(r)}}function yn(e,t){W(e,t);const r=null==e?void 0:e.preventAbort,n=null==e?void 0:e.preventCancel,a=null==e?void 0:e.preventClose,o=null==e?void 0:e.signal;return void 0!==o&&_n(o,`${t} has member 'signal' that`),{preventAbort:Boolean(r),preventCancel:Boolean(n),preventClose:Boolean(a),signal:o}}function _n(e,t){if(!Et(e))throw new TypeError(`${t} is not an AbortSignal.`)}function gn(e,t){W(e,t);const r=null==e?void 0:e.readable;K(r,"readable","ReadableWritablePair"),X(r,`${t} has member 'readable' that`);const n=null==e?void 0:e.writable;return K(n,"writable","ReadableWritablePair"),kt(n,`${t} has member 'writable' that`),{readable:r,writable:n}}Object.defineProperties(Fr.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(Fr.prototype,t.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});class bn{constructor(e={},t={}){void 0===e?e=null:H(e,"First parameter");const r=_t(t,"Second parameter"),n=ln(e,"First parameter");if(Sn(this),"bytes"===n.type){if(void 0!==r.size)throw new RangeError("The strategy for a byte stream cannot have a size function");rt(this,n,mt(r,0))}else{const e=yt(r);rn(this,n,mt(r,1),e)}}get locked(){if(!Tn(this))throw Pn("locked");return kn(this)}cancel(e=void 0){return Tn(this)?kn(this)?p(new TypeError("Cannot cancel a stream that already has a reader")):En(this,e):p(Pn("cancel"))}getReader(e=void 0){if(!Tn(this))throw Pn("getReader");return void 0===fn(e,"First parameter").mode?ee(this):st(this)}pipeThrough(e,t={}){if(!Tn(this))throw Pn("pipeThrough");V(e,1,"pipeThrough");const r=gn(e,"First parameter"),n=yn(t,"Second parameter");if(kn(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(qt(r.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");return v(Wr(this,r.writable,n.preventClose,n.preventAbort,n.preventCancel,n.signal)),r.readable}pipeTo(e,t={}){if(!Tn(this))return p(Pn("pipeTo"));if(void 0===e)return p("Parameter 1 is required in 'pipeTo'.");if(!jt(e))return p(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));let r;try{r=yn(t,"Second parameter")}catch(e){return p(e)}return kn(this)?p(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):qt(e)?p(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):Wr(this,e,r.preventClose,r.preventAbort,r.preventCancel,r.signal)}tee(){if(!Tn(this))throw Pn("tee");return ye(an(this))}values(e=void 0){if(!Tn(this))throw Pn("values");return he(this,mn(e,"First parameter").preventCancel)}}function vn(e,t,r,n=1,a=()=>1){const o=Object.create(bn.prototype);return Sn(o),tn(o,Object.create(Fr.prototype),e,t,r,n,a),o}function wn(e,t,r){const n=Object.create(bn.prototype);return Sn(n),tt(n,Object.create(Pe.prototype),e,t,r,0,void 0),n}function Sn(e){e._state="readable",e._reader=void 0,e._storedError=void 0,e._disturbed=!1}function Tn(e){return!!o(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readableStreamController")&&e instanceof bn}function kn(e){return void 0!==e._reader}function En(e,t){if(e._disturbed=!0,"closed"===e._state)return f(void 0);if("errored"===e._state)return p(e._storedError);Rn(e);const n=e._reader;return void 0!==n&&ht(n)&&(n._readIntoRequests.forEach((e=>{e._closeSteps(void 0)})),n._readIntoRequests=new E),b(e._readableStreamController[N](t),r)}function Rn(e){e._state="closed";const t=e._reader;void 0!==t&&(L(t),se(t)&&(t._readRequests.forEach((e=>{e._closeSteps()})),t._readRequests=new E))}function xn(e,t){e._state="errored",e._storedError=t;const r=e._reader;void 0!==r&&(q(r,t),se(r)?(r._readRequests.forEach((e=>{e._errorSteps(t)})),r._readRequests=new E):(r._readIntoRequests.forEach((e=>{e._errorSteps(t)})),r._readIntoRequests=new E))}function Pn(e){return new TypeError(`ReadableStream.prototype.${e} can only be used on a ReadableStream`)}function Cn(e,t){W(e,t);const r=null==e?void 0:e.highWaterMark;return K(r,"highWaterMark","QueuingStrategyInit"),{highWaterMark:Y(r)}}Object.defineProperties(bn.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(bn.prototype,t.toStringTag,{value:"ReadableStream",configurable:!0}),"symbol"==typeof t.asyncIterator&&Object.defineProperty(bn.prototype,t.asyncIterator,{value:bn.prototype.values,writable:!0,configurable:!0});const An=e=>e.byteLength;try{Object.defineProperty(An,"name",{value:"size",configurable:!0})}catch(e){}class On{constructor(e){V(e,1,"ByteLengthQueuingStrategy"),e=Cn(e,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=e.highWaterMark}get highWaterMark(){if(!qn(this))throw jn("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!qn(this))throw jn("size");return An}}function jn(e){return new TypeError(`ByteLengthQueuingStrategy.prototype.${e} can only be used on a ByteLengthQueuingStrategy`)}function qn(e){return!!o(e)&&!!Object.prototype.hasOwnProperty.call(e,"_byteLengthQueuingStrategyHighWaterMark")&&e instanceof On}Object.defineProperties(On.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(On.prototype,t.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});const In=()=>1;try{Object.defineProperty(In,"name",{value:"size",configurable:!0})}catch(e){}class Ln{constructor(e){V(e,1,"CountQueuingStrategy"),e=Cn(e,"First parameter"),this._countQueuingStrategyHighWaterMark=e.highWaterMark}get highWaterMark(){if(!Zn(this))throw $n("highWaterMark");return this._countQueuingStrategyHighWaterMark}get size(){if(!Zn(this))throw $n("size");return In}}function $n(e){return new TypeError(`CountQueuingStrategy.prototype.${e} can only be used on a CountQueuingStrategy`)}function Zn(e){return!!o(e)&&!!Object.prototype.hasOwnProperty.call(e,"_countQueuingStrategyHighWaterMark")&&e instanceof Ln}function Nn(e,t){W(e,t);const r=null==e?void 0:e.flush,n=null==e?void 0:e.readableType,a=null==e?void 0:e.start,o=null==e?void 0:e.transform,s=null==e?void 0:e.writableType;return{flush:void 0===r?void 0:Bn(r,e,`${t} has member 'flush' that`),readableType:n,start:void 0===a?void 0:zn(a,e,`${t} has member 'start' that`),transform:void 0===o?void 0:Dn(o,e,`${t} has member 'transform' that`),writableType:s}}function Bn(e,t,r){return F(e,r),r=>T(e,t,[r])}function zn(e,t,r){return F(e,r),r=>S(e,t,[r])}function Dn(e,t,r){return F(e,r),(r,n)=>T(e,t,[r,n])}Object.defineProperties(Ln.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(Ln.prototype,t.toStringTag,{value:"CountQueuingStrategy",configurable:!0});class Mn{constructor(e={},t={},r={}){void 0===e&&(e=null);const n=_t(t,"Second parameter"),a=_t(r,"Third parameter"),o=Nn(e,"First parameter");if(void 0!==o.readableType)throw new RangeError("Invalid readableType specified");if(void 0!==o.writableType)throw new RangeError("Invalid writableType specified");const s=mt(a,0),i=yt(a),l=mt(n,1),u=yt(n);let c;Wn(this,h((e=>{c=e})),l,u,s,i),Qn(this,o),void 0!==o.start?c(o.start(this._transformStreamController)):c(void 0)}get readable(){if(!Fn(this))throw la("readable");return this._readable}get writable(){if(!Fn(this))throw la("writable");return this._writable}}function Wn(e,t,r,n,a,o){function s(){return t}function i(t){return na(e,t)}function l(t){return aa(e,t)}function u(){return oa(e)}function c(){return sa(e)}function d(t){return Hn(e,t),f(void 0)}e._writable=At(s,i,u,l,r,n),e._readable=vn(s,c,d,a,o),e._backpressure=void 0,e._backpressureChangePromise=void 0,e._backpressureChangePromise_resolve=void 0,Vn(e,!0),e._transformStreamController=void 0}function Fn(e){return!!o(e)&&!!Object.prototype.hasOwnProperty.call(e,"_transformStreamController")&&e instanceof Mn}function Un(e,t){Qr(e._readable._readableStreamController,t),Hn(e,t)}function Hn(e,t){Jn(e._transformStreamController),_r(e._writable._writableStreamController,t),e._backpressure&&Vn(e,!1)}function Vn(e,t){void 0!==e._backpressureChangePromise&&e._backpressureChangePromise_resolve(),e._backpressureChangePromise=h((t=>{e._backpressureChangePromise_resolve=t})),e._backpressure=t}Object.defineProperties(Mn.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(Mn.prototype,t.toStringTag,{value:"TransformStream",configurable:!0});class Kn{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Yn(this))throw ia("desiredSize");return Jr(this._controlledTransformStream._readable._readableStreamController)}enqueue(e=void 0){if(!Yn(this))throw ia("enqueue");Xn(this,e)}error(e=void 0){if(!Yn(this))throw ia("error");ea(this,e)}terminate(){if(!Yn(this))throw ia("terminate");ra(this)}}function Yn(e){return!!o(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledTransformStream")&&e instanceof Kn}function Gn(e,t,r,n){t._controlledTransformStream=e,e._transformStreamController=t,t._transformAlgorithm=r,t._flushAlgorithm=n}function Qn(e,t){const r=Object.create(Kn.prototype);let n=e=>{try{return Xn(r,e),f(void 0)}catch(e){return p(e)}},a=()=>f(void 0);void 0!==t.transform&&(n=e=>t.transform(e,r)),void 0!==t.flush&&(a=()=>t.flush(r)),Gn(e,r,n,a)}function Jn(e){e._transformAlgorithm=void 0,e._flushAlgorithm=void 0}function Xn(e,t){const r=e._controlledTransformStream,n=r._readable._readableStreamController;if(!en(n))throw new TypeError("Readable side is not in a state that permits enqueue");try{Gr(n,t)}catch(e){throw Hn(r,e),r._readable._storedError}Xr(n)!==r._backpressure&&Vn(r,!0)}function ea(e,t){Un(e._controlledTransformStream,t)}function ta(e,t){return b(e._transformAlgorithm(t),void 0,(t=>{throw Un(e._controlledTransformStream,t),t}))}function ra(e){const t=e._controlledTransformStream;Yr(t._readable._readableStreamController),Hn(t,new TypeError("TransformStream terminated"))}function na(e,t){const r=e._transformStreamController;return e._backpressure?b(e._backpressureChangePromise,(()=>{const n=e._writable;if("erroring"===n._state)throw n._storedError;return ta(r,t)})):ta(r,t)}function aa(e,t){return Un(e,t),f(void 0)}function oa(e){const t=e._readable,r=e._transformStreamController,n=r._flushAlgorithm();return Jn(r),b(n,(()=>{if("errored"===t._state)throw t._storedError;Yr(t._readableStreamController)}),(r=>{throw Un(e,r),t._storedError}))}function sa(e){return Vn(e,!1),e._backpressureChangePromise}function ia(e){return new TypeError(`TransformStreamDefaultController.prototype.${e} can only be used on a TransformStreamDefaultController`)}function la(e){return new TypeError(`TransformStream.prototype.${e} can only be used on a TransformStream`)}Object.defineProperties(Kn.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(Kn.prototype,t.toStringTag,{value:"TransformStreamDefaultController",configurable:!0}),e.ByteLengthQueuingStrategy=On,e.CountQueuingStrategy=Ln,e.ReadableByteStreamController=Pe,e.ReadableStream=bn,e.ReadableStreamBYOBReader=dt,e.ReadableStreamBYOBRequest=xe,e.ReadableStreamDefaultController=Fr,e.ReadableStreamDefaultReader=oe,e.TransformStream=Mn,e.TransformStreamDefaultController=Kn,e.WritableStream=Pt,e.WritableStreamDefaultController=ir,e.WritableStreamDefaultWriter=Gt,Object.defineProperty(e,"__esModule",{value:!0})}(Yt.exports)),Yt.exports))}try{const{Blob:e}=require("buffer");e&&!e.prototype.stream&&(e.prototype.stream=function(e){let t=0;const r=this;return new ReadableStream({type:"bytes",async pull(e){const n=r.slice(t,Math.min(r.size,t+65536)),a=await n.arrayBuffer();t+=a.byteLength,e.enqueue(new Uint8Array(a)),t===r.size&&e.close()}})})}catch(e){}
/*! fetch-blob. MIT License. Jimmy Wärting <https://jimmy.warting.se/opensource> */async function*Gt(e,t=!0){for(const r of e)if("stream"in r)yield*r.stream();else if(ArrayBuffer.isView(r))if(t){let e=r.byteOffset;const t=r.byteOffset+r.byteLength;for(;e!==t;){const n=Math.min(t-e,65536),a=r.buffer.slice(e,e+n);e+=a.byteLength,yield new Uint8Array(a)}}else yield r;else{let e=0,t=r;for(;e!==t.size;){const r=t.slice(e,Math.min(t.size,e+65536)),n=await r.arrayBuffer();e+=n.byteLength,yield new Uint8Array(n)}}}const Qt=class e{#e=[];#t="";#r=0;#n="transparent";constructor(t=[],r={}){if("object"!=typeof t||null===t)throw new TypeError("Failed to construct 'Blob': The provided value cannot be converted to a sequence.");if("function"!=typeof t[Symbol.iterator])throw new TypeError("Failed to construct 'Blob': The object must have a callable @@iterator property.");if("object"!=typeof r&&"function"!=typeof r)throw new TypeError("Failed to construct 'Blob': parameter 2 cannot convert to dictionary.");null===r&&(r={});const n=new TextEncoder;for(const r of t){let t;t=ArrayBuffer.isView(r)?new Uint8Array(r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)):r instanceof ArrayBuffer?new Uint8Array(r.slice(0)):r instanceof e?r:n.encode(`${r}`),this.#r+=ArrayBuffer.isView(t)?t.byteLength:t.size,this.#e.push(t)}this.#n=`${void 0===r.endings?"transparent":r.endings}`;const a=void 0===r.type?"":String(r.type);this.#t=/^[\x20-\x7E]*$/.test(a)?a:""}get size(){return this.#r}get type(){return this.#t}async text(){const e=new TextDecoder;let t="";for await(const r of Gt(this.#e,!1))t+=e.decode(r,{stream:!0});return t+=e.decode(),t}async arrayBuffer(){const e=new Uint8Array(this.size);let t=0;for await(const r of Gt(this.#e,!1))e.set(r,t),t+=r.length;return e.buffer}stream(){const e=Gt(this.#e,!0);return new globalThis.ReadableStream({type:"bytes",async pull(t){const r=await e.next();r.done?t.close():t.enqueue(r.value)},async cancel(){await e.return()}})}slice(t=0,r=this.size,n=""){const{size:a}=this;let o=t<0?Math.max(a+t,0):Math.min(t,a),s=r<0?Math.max(a+r,0):Math.min(r,a);const i=Math.max(s-o,0),l=this.#e,u=[];let c=0;for(const e of l){if(c>=i)break;const t=ArrayBuffer.isView(e)?e.byteLength:e.size;if(o&&t<=o)o-=t,s-=t;else{let r;ArrayBuffer.isView(e)?(r=e.subarray(o,Math.min(t,s)),c+=r.byteLength):(r=e.slice(o,Math.min(t,s)),c+=r.size),s-=t,u.push(r),o=0}}const d=new e([],{type:String(n).toLowerCase()});return d.#r=i,d.#e=u,d}get[Symbol.toStringTag](){return"Blob"}static[Symbol.hasInstance](e){return e&&"object"==typeof e&&"function"==typeof e.constructor&&("function"==typeof e.stream||"function"==typeof e.arrayBuffer)&&/^(Blob|File)$/.test(e[Symbol.toStringTag])}};Object.defineProperties(Qt.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}});var Jt=Qt;const Xt=class extends Jt{#a=0;#o="";constructor(e,t,r={}){if(arguments.length<2)throw new TypeError(`Failed to construct 'File': 2 arguments required, but only ${arguments.length} present.`);super(e,r),null===r&&(r={});const n=void 0===r.lastModified?Date.now():Number(r.lastModified);Number.isNaN(n)||(this.#a=n),this.#o=String(t)}get name(){return this.#o}get lastModified(){return this.#a}get[Symbol.toStringTag](){return"File"}static[Symbol.hasInstance](e){return!!e&&e instanceof Jt&&/^(File)$/.test(e[Symbol.toStringTag])}};
/*! formdata-polyfill. MIT License. Jimmy Wärting <https://jimmy.warting.se/opensource> */
var{toStringTag:er,iterator:tr,hasInstance:rr}=Symbol,nr=Math.random,ar="append,set,get,getAll,delete,keys,values,entries,forEach,constructor".split(","),or=(e,t,r)=>(e+="",/^(Blob|File)$/.test(t&&t[er])?[(r=void 0!==r?r+"":"File"==t[er]?t.name:"blob",e),t.name!==r||"blob"==t[er]?new Xt([t],r,t):t]:[e,t+""]),sr=(e,t)=>(t?e:e.replace(/\r?\n|\r/g,"\r\n")).replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22"),ir=(e,t,r)=>{if(t.length<r)throw new TypeError(`Failed to execute '${e}' on 'FormData': ${r} arguments required, but only ${t.length} present.`)};const lr=class{#s=[];constructor(...e){if(e.length)throw new TypeError("Failed to construct 'FormData': parameter 1 is not of type 'HTMLFormElement'.")}get[er](){return"FormData"}[tr](){return this.entries()}static[rr](e){return e&&"object"==typeof e&&"FormData"===e[er]&&!ar.some((t=>"function"!=typeof e[t]))}append(...e){ir("append",arguments,2),this.#s.push(or(...e))}delete(e){ir("delete",arguments,1),e+="",this.#s=this.#s.filter((([t])=>t!==e))}get(e){ir("get",arguments,1),e+="";for(var t=this.#s,r=t.length,n=0;n<r;n++)if(t[n][0]===e)return t[n][1];return null}getAll(e,t){return ir("getAll",arguments,1),t=[],e+="",this.#s.forEach((r=>r[0]===e&&t.push(r[1]))),t}has(e){return ir("has",arguments,1),e+="",this.#s.some((t=>t[0]===e))}forEach(e,t){for(var[r,n]of(ir("forEach",arguments,1),this))e.call(t,n,r,this)}set(...e){ir("set",arguments,2);var t=[],r=!0;e=or(...e),this.#s.forEach((n=>{n[0]===e[0]?r&&(r=!t.push(e)):t.push(n)})),r&&t.push(e),this.#s=t}*entries(){yield*this.#s}*keys(){for(var[e]of this)yield e}*values(){for(var[,e]of this)yield e}};class ur extends Error{constructor(e,t){super(e),Error.captureStackTrace(this,this.constructor),this.type=t}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}}class cr extends ur{constructor(e,t,r){super(e,t),r&&(this.code=this.errno=r.code,this.erroredSysCall=r.syscall)}}const dr=Symbol.toStringTag,hr=e=>"object"==typeof e&&"function"==typeof e.append&&"function"==typeof e.delete&&"function"==typeof e.get&&"function"==typeof e.getAll&&"function"==typeof e.has&&"function"==typeof e.set&&"function"==typeof e.sort&&"URLSearchParams"===e[dr],fr=e=>e&&"object"==typeof e&&"function"==typeof e.arrayBuffer&&"string"==typeof e.type&&"function"==typeof e.stream&&"function"==typeof e.constructor&&/^(Blob|File)$/.test(e[dr]),pr=s.promisify(a.pipeline),mr=Symbol("Body internals");class yr{constructor(e,{size:t=0}={}){let r=null;null===e?e=null:hr(e)?e=o.Buffer.from(e.toString()):fr(e)||o.Buffer.isBuffer(e)||(s.types.isAnyArrayBuffer(e)?e=o.Buffer.from(e):ArrayBuffer.isView(e)?e=o.Buffer.from(e.buffer,e.byteOffset,e.byteLength):e instanceof a||(e instanceof lr?(e=function(e,t=Jt){var r=`${nr()}${nr()}`.replace(/\./g,"").slice(-28).padStart(32,"-"),n=[],a=`--${r}\r\nContent-Disposition: form-data; name="`;return e.forEach(((e,t)=>"string"==typeof e?n.push(a+sr(t)+`"\r\n\r\n${e.replace(/\r(?!\n)|(?<!\r)\n/g,"\r\n")}\r\n`):n.push(a+sr(t)+`"; filename="${sr(e.name,1)}"\r\nContent-Type: ${e.type||"application/octet-stream"}\r\n\r\n`,e,"\r\n"))),n.push(`--${r}--`),new t(n,{type:"multipart/form-data; boundary="+r})}(e),r=e.type.split("=")[1]):e=o.Buffer.from(String(e))));let n=e;o.Buffer.isBuffer(e)?n=a.Readable.from(e):fr(e)&&(n=a.Readable.from(e.stream())),this[mr]={body:e,stream:n,boundary:r,disturbed:!1,error:null},this.size=t,e instanceof a&&e.on("error",(e=>{const t=e instanceof ur?e:new cr(`Invalid response body while trying to fetch ${this.url}: ${e.message}`,"system",e);this[mr].error=t}))}get body(){return this[mr].stream}get bodyUsed(){return this[mr].disturbed}async arrayBuffer(){const{buffer:e,byteOffset:t,byteLength:r}=await _r(this);return e.slice(t,t+r)}async formData(){const e=this.headers.get("content-type");if(e.startsWith("application/x-www-form-urlencoded")){const e=new lr,t=new URLSearchParams(await this.text());for(const[r,n]of t)e.append(r,n);return e}const{toFormData:t}=await Promise.resolve().then((function(){return en}));return t(this.body,e)}async blob(){const e=this.headers&&this.headers.get("content-type")||this[mr].body&&this[mr].body.type||"",t=await this.arrayBuffer();return new Jt([t],{type:e})}async json(){const e=await this.text();return JSON.parse(e)}async text(){const e=await _r(this);return(new TextDecoder).decode(e)}buffer(){return _r(this)}}async function _r(e){if(e[mr].disturbed)throw new TypeError(`body used already for: ${e.url}`);if(e[mr].disturbed=!0,e[mr].error)throw e[mr].error;const{body:t}=e;if(null===t)return o.Buffer.alloc(0);if(!(t instanceof a))return o.Buffer.alloc(0);const r=[];let n=0;try{for await(const a of t){if(e.size>0&&n+a.length>e.size){const r=new cr(`content size at ${e.url} over limit: ${e.size}`,"max-size");throw t.destroy(r),r}n+=a.length,r.push(a)}}catch(t){throw t instanceof ur?t:new cr(`Invalid response body while trying to fetch ${e.url}: ${t.message}`,"system",t)}if(!0!==t.readableEnded&&!0!==t._readableState.ended)throw new cr(`Premature close of server response while trying to fetch ${e.url}`);try{return r.every((e=>"string"==typeof e))?o.Buffer.from(r.join("")):o.Buffer.concat(r,n)}catch(t){throw new cr(`Could not create Buffer from response body for ${e.url}: ${t.message}`,"system",t)}}yr.prototype.buffer=s.deprecate(yr.prototype.buffer,"Please use 'response.arrayBuffer()' instead of 'response.buffer()'","node-fetch#buffer"),Object.defineProperties(yr.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0},data:{get:s.deprecate((()=>{}),"data doesn't exist, use json(), text(), arrayBuffer(), or body instead","https://github.com/node-fetch/node-fetch/issues/1000 (response)")}});const gr=(e,t)=>{let r,n,{body:o}=e[mr];if(e.bodyUsed)throw new Error("cannot clone body after it is used");return o instanceof a&&"function"!=typeof o.getBoundary&&(r=new a.PassThrough({highWaterMark:t}),n=new a.PassThrough({highWaterMark:t}),o.pipe(r),o.pipe(n),e[mr].stream=r,o=n),o},br=s.deprecate((e=>e.getBoundary()),"form-data doesn't follow the spec and requires special treatment. Use alternative package","https://github.com/node-fetch/node-fetch/issues/1167"),vr=(e,t)=>null===e?null:"string"==typeof e?"text/plain;charset=UTF-8":hr(e)?"application/x-www-form-urlencoded;charset=UTF-8":fr(e)?e.type||null:o.Buffer.isBuffer(e)||s.types.isAnyArrayBuffer(e)||ArrayBuffer.isView(e)?null:e instanceof lr?`multipart/form-data; boundary=${t[mr].boundary}`:e&&"function"==typeof e.getBoundary?`multipart/form-data;boundary=${br(e)}`:e instanceof a?null:"text/plain;charset=UTF-8",wr="function"==typeof t.validateHeaderName?t.validateHeaderName:e=>{if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(e)){const t=new TypeError(`Header name must be a valid HTTP token [${e}]`);throw Object.defineProperty(t,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),t}},Sr="function"==typeof t.validateHeaderValue?t.validateHeaderValue:(e,t)=>{if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(t)){const t=new TypeError(`Invalid character in header content ["${e}"]`);throw Object.defineProperty(t,"code",{value:"ERR_INVALID_CHAR"}),t}};class Tr extends URLSearchParams{constructor(e){let t=[];if(e instanceof Tr){const r=e.raw();for(const[e,n]of Object.entries(r))t.push(...n.map((t=>[e,t])))}else if(null==e);else{if("object"!=typeof e||s.types.isBoxedPrimitive(e))throw new TypeError("Failed to construct 'Headers': The provided value is not of type '(sequence<sequence<ByteString>> or record<ByteString, ByteString>)");{const r=e[Symbol.iterator];if(null==r)t.push(...Object.entries(e));else{if("function"!=typeof r)throw new TypeError("Header pairs must be iterable");t=[...e].map((e=>{if("object"!=typeof e||s.types.isBoxedPrimitive(e))throw new TypeError("Each header pair must be an iterable object");return[...e]})).map((e=>{if(2!==e.length)throw new TypeError("Each header pair must be a name/value tuple");return[...e]}))}}}return t=t.length>0?t.map((([e,t])=>(wr(e),Sr(e,String(t)),[String(e).toLowerCase(),String(t)]))):void 0,super(t),new Proxy(this,{get(e,t,r){switch(t){case"append":case"set":return(r,n)=>(wr(r),Sr(r,String(n)),URLSearchParams.prototype[t].call(e,String(r).toLowerCase(),String(n)));case"delete":case"has":case"getAll":return r=>(wr(r),URLSearchParams.prototype[t].call(e,String(r).toLowerCase()));case"keys":return()=>(e.sort(),new Set(URLSearchParams.prototype.keys.call(e)).keys());default:return Reflect.get(e,t,r)}}})}get[Symbol.toStringTag](){return this.constructor.name}toString(){return Object.prototype.toString.call(this)}get(e){const t=this.getAll(e);if(0===t.length)return null;let r=t.join(", ");return/^content-encoding$/i.test(e)&&(r=r.toLowerCase()),r}forEach(e,t=void 0){for(const r of this.keys())Reflect.apply(e,t,[this.get(r),r,this])}*values(){for(const e of this.keys())yield this.get(e)}*entries(){for(const e of this.keys())yield[e,this.get(e)]}[Symbol.iterator](){return this.entries()}raw(){return[...this.keys()].reduce(((e,t)=>(e[t]=this.getAll(t),e)),{})}[Symbol.for("nodejs.util.inspect.custom")](){return[...this.keys()].reduce(((e,t)=>{const r=this.getAll(t);return e[t]="host"===t?r[0]:r.length>1?r:r[0],e}),{})}}Object.defineProperties(Tr.prototype,["get","entries","forEach","values"].reduce(((e,t)=>(e[t]={enumerable:!0},e)),{}));const kr=new Set([301,302,303,307,308]),Er=e=>kr.has(e),Rr=Symbol("Response internals");class xr extends yr{constructor(e=null,t={}){super(e,t);const r=null!=t.status?t.status:200,n=new Tr(t.headers);if(null!==e&&!n.has("Content-Type")){const t=vr(e,this);t&&n.append("Content-Type",t)}this[Rr]={type:"default",url:t.url,status:r,statusText:t.statusText||"",headers:n,counter:t.counter,highWaterMark:t.highWaterMark}}get type(){return this[Rr].type}get url(){return this[Rr].url||""}get status(){return this[Rr].status}get ok(){return this[Rr].status>=200&&this[Rr].status<300}get redirected(){return this[Rr].counter>0}get statusText(){return this[Rr].statusText}get headers(){return this[Rr].headers}get highWaterMark(){return this[Rr].highWaterMark}clone(){return new xr(gr(this,this.highWaterMark),{type:this.type,url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected,size:this.size,highWaterMark:this.highWaterMark})}static redirect(e,t=302){if(!Er(t))throw new RangeError('Failed to execute "redirect" on "response": Invalid status code');return new xr(null,{headers:{location:new URL(e).toString()},status:t})}static error(){const e=new xr(null,{status:0,statusText:""});return e[Rr].type="error",e}static json(e=void 0,t={}){const r=JSON.stringify(e);if(void 0===r)throw new TypeError("data is not JSON serializable");const n=new Tr(t&&t.headers);return n.has("content-type")||n.set("content-type","application/json"),new xr(r,{...t,headers:n})}get[Symbol.toStringTag](){return"Response"}}Object.defineProperties(xr.prototype,{type:{enumerable:!0},url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});function Pr(e,t=!1){return null==e?"no-referrer":(e=new URL(e),/^(about|blob|data):$/.test(e.protocol)?"no-referrer":(e.username="",e.password="",e.hash="",t&&(e.pathname="",e.search=""),e))}const Cr=new Set(["","no-referrer","no-referrer-when-downgrade","same-origin","origin","strict-origin","origin-when-cross-origin","strict-origin-when-cross-origin","unsafe-url"]);function Ar(e){return!!/^about:(blank|srcdoc)$/.test(e)||("data:"===e.protocol||(!!/^(blob|filesystem):$/.test(e.protocol)||function(e){if(/^(http|ws)s:$/.test(e.protocol))return!0;const t=e.host.replace(/(^\[)|(]$)/g,""),r=l.isIP(t);return!(4!==r||!/^127\./.test(t))||!(6!==r||!/^(((0+:){7})|(::(0+:){0,6}))0*1$/.test(t))||"localhost"!==e.host&&!e.host.endsWith(".localhost")&&"file:"===e.protocol}(e)))}const Or=Symbol("Request internals"),jr=e=>"object"==typeof e&&"object"==typeof e[Or],qr=s.deprecate((()=>{}),".data is not a valid RequestInit property, use .body instead","https://github.com/node-fetch/node-fetch/issues/1000 (request)");class Ir extends yr{constructor(e,t={}){let r;if(jr(e)?r=new URL(e.url):(r=new URL(e),e={}),""!==r.username||""!==r.password)throw new TypeError(`${r} is an url with embedded credentials.`);let n=t.method||e.method||"GET";if(/^(delete|get|head|options|post|put)$/i.test(n)&&(n=n.toUpperCase()),!jr(t)&&"data"in t&&qr(),(null!=t.body||jr(e)&&null!==e.body)&&("GET"===n||"HEAD"===n))throw new TypeError("Request with GET/HEAD method cannot have body");const a=t.body?t.body:jr(e)&&null!==e.body?gr(e):null;super(a,{size:t.size||e.size||0});const o=new Tr(t.headers||e.headers||{});if(null!==a&&!o.has("Content-Type")){const e=vr(a,this);e&&o.set("Content-Type",e)}let s=jr(e)?e.signal:null;if("signal"in t&&(s=t.signal),null!=s&&("object"!=typeof(i=s)||"AbortSignal"!==i[dr]&&"EventTarget"!==i[dr]))throw new TypeError("Expected signal to be an instanceof AbortSignal or EventTarget");var i;let l=null==t.referrer?e.referrer:t.referrer;if(""===l)l="no-referrer";else if(l){const e=new URL(l);l=/^about:(\/\/)?client$/.test(e)?"client":e}else l=void 0;this[Or]={method:n,redirect:t.redirect||e.redirect||"follow",headers:o,parsedURL:r,signal:s,referrer:l},this.follow=void 0===t.follow?void 0===e.follow?20:e.follow:t.follow,this.compress=void 0===t.compress?void 0===e.compress||e.compress:t.compress,this.counter=t.counter||e.counter||0,this.agent=t.agent||e.agent,this.highWaterMark=t.highWaterMark||e.highWaterMark||16384,this.insecureHTTPParser=t.insecureHTTPParser||e.insecureHTTPParser||!1,this.referrerPolicy=t.referrerPolicy||e.referrerPolicy||""}get method(){return this[Or].method}get url(){return i.format(this[Or].parsedURL)}get headers(){return this[Or].headers}get redirect(){return this[Or].redirect}get signal(){return this[Or].signal}get referrer(){return"no-referrer"===this[Or].referrer?"":"client"===this[Or].referrer?"about:client":this[Or].referrer?this[Or].referrer.toString():void 0}get referrerPolicy(){return this[Or].referrerPolicy}set referrerPolicy(e){this[Or].referrerPolicy=function(e){if(!Cr.has(e))throw new TypeError(`Invalid referrerPolicy: ${e}`);return e}(e)}clone(){return new Ir(this)}get[Symbol.toStringTag](){return"Request"}}Object.defineProperties(Ir.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0},referrer:{enumerable:!0},referrerPolicy:{enumerable:!0}});const Lr=e=>{const{parsedURL:t}=e[Or],r=new Tr(e[Or].headers);r.has("Accept")||r.set("Accept","*/*");let n=null;if(null===e.body&&/^(post|put)$/i.test(e.method)&&(n="0"),null!==e.body){const t=(e=>{const{body:t}=e[mr];return null===t?0:fr(t)?t.size:o.Buffer.isBuffer(t)?t.length:t&&"function"==typeof t.getLengthSync&&t.hasKnownLength&&t.hasKnownLength()?t.getLengthSync():null})(e);"number"!=typeof t||Number.isNaN(t)||(n=String(t))}n&&r.set("Content-Length",n),""===e.referrerPolicy&&(e.referrerPolicy="strict-origin-when-cross-origin"),e.referrer&&"no-referrer"!==e.referrer?e[Or].referrer=function(e,{referrerURLCallback:t,referrerOriginCallback:r}={}){if("no-referrer"===e.referrer||""===e.referrerPolicy)return null;const n=e.referrerPolicy;if("about:client"===e.referrer)return"no-referrer";const a=e.referrer;let o=Pr(a),s=Pr(a,!0);o.toString().length>4096&&(o=s),t&&(o=t(o)),r&&(s=r(s));const i=new URL(e.url);switch(n){case"no-referrer":return"no-referrer";case"origin":return s;case"unsafe-url":return o;case"strict-origin":return Ar(o)&&!Ar(i)?"no-referrer":s.toString();case"strict-origin-when-cross-origin":return o.origin===i.origin?o:Ar(o)&&!Ar(i)?"no-referrer":s;case"same-origin":return o.origin===i.origin?o:"no-referrer";case"origin-when-cross-origin":return o.origin===i.origin?o:s;case"no-referrer-when-downgrade":return Ar(o)&&!Ar(i)?"no-referrer":o;default:throw new TypeError(`Invalid referrerPolicy: ${n}`)}}(e):e[Or].referrer="no-referrer",e[Or].referrer instanceof URL&&r.set("Referer",e.referrer),r.has("User-Agent")||r.set("User-Agent","node-fetch"),e.compress&&!r.has("Accept-Encoding")&&r.set("Accept-Encoding","gzip, deflate, br");let{agent:a}=e;"function"==typeof a&&(a=a(t));const s=(e=>{if(e.search)return e.search;const t=e.href.length-1,r=e.hash||("#"===e.href[t]?"#":"");return"?"===e.href[t-r.length]?"?":""})(t);return{parsedURL:t,options:{path:t.pathname+s,method:e.method,headers:r[Symbol.for("nodejs.util.inspect.custom")](),insecureHTTPParser:e.insecureHTTPParser,agent:a}}};class $r extends ur{constructor(e,t="aborted"){super(e,t)}}
/*! node-domexception. MIT License. Jimmy Wärting <https://jimmy.warting.se/opensource> */if(!globalThis.DOMException)try{const{MessageChannel:e}=require("worker_threads"),t=(new e).port1,r=new ArrayBuffer;t.postMessage(r,[r,r])}catch(e){"DOMException"===e.constructor.name&&(globalThis.DOMException=e.constructor)}const Zr=new Set(["data:","http:","https:"]);async function Nr(e,s){return new Promise(((i,l)=>{const u=new Ir(e,s),{parsedURL:c,options:d}=Lr(u);if(!Zr.has(c.protocol))throw new TypeError(`node-fetch cannot load ${e}. URL scheme "${c.protocol.replace(/:$/,"")}" is not supported.`);if("data:"===c.protocol){const e=function(e){if(!/^data:/i.test(e))throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');const t=(e=e.replace(/\r?\n/g,"")).indexOf(",");if(-1===t||t<=4)throw new TypeError("malformed data: URI");const r=e.substring(5,t).split(";");let n="",a=!1;const o=r[0]||"text/plain";let s=o;for(let e=1;e<r.length;e++)"base64"===r[e]?a=!0:(s+=`;${r[e]}`,0===r[e].indexOf("charset=")&&(n=r[e].substring(8)));r[0]||n.length||(s+=";charset=US-ASCII",n="US-ASCII");const i=a?"base64":"ascii",l=unescape(e.substring(t+1)),u=Buffer.from(l,i);return u.type=o,u.typeFull=s,u.charset=n,u}(u.url),t=new xr(e,{headers:{"Content-Type":e.typeFull}});return void i(t)}const h=("https:"===c.protocol?r:t).request,{signal:f}=u;let p=null;const m=()=>{const e=new $r("The operation was aborted.");l(e),u.body&&u.body instanceof a.Readable&&u.body.destroy(e),p&&p.body&&p.body.emit("error",e)};if(f&&f.aborted)return void m();const y=()=>{m(),g()},_=h(c.toString(),d);f&&f.addEventListener("abort",y);const g=()=>{_.abort(),f&&f.removeEventListener("abort",y)};_.on("error",(e=>{l(new cr(`request to ${u.url} failed, reason: ${e.message}`,"system",e)),g()})),function(e,t){const r=o.Buffer.from("0\r\n\r\n");let n,a=!1,s=!1;e.on("response",(e=>{const{headers:t}=e;a="chunked"===t["transfer-encoding"]&&!t["content-length"]})),e.on("socket",(i=>{const l=()=>{if(a&&!s){const e=new Error("Premature close");e.code="ERR_STREAM_PREMATURE_CLOSE",t(e)}},u=e=>{s=0===o.Buffer.compare(e.slice(-5),r),!s&&n&&(s=0===o.Buffer.compare(n.slice(-3),r.slice(0,3))&&0===o.Buffer.compare(e.slice(-2),r.slice(3))),n=e};i.prependListener("close",l),i.on("data",u),e.on("close",(()=>{i.removeListener("close",l),i.removeListener("data",u)}))}))}(_,(e=>{p&&p.body&&p.body.destroy(e)})),process.version<"v14"&&_.on("socket",(e=>{let t;e.prependListener("end",(()=>{t=e._eventsCount})),e.prependListener("close",(r=>{if(p&&t<e._eventsCount&&!r){const e=new Error("Premature close");e.code="ERR_STREAM_PREMATURE_CLOSE",p.body.emit("error",e)}}))})),_.on("response",(e=>{_.setTimeout(0);const t=function(e=[]){return new Tr(e.reduce(((e,t,r,n)=>(r%2==0&&e.push(n.slice(r,r+2)),e)),[]).filter((([e,t])=>{try{return wr(e),Sr(e,String(t)),!0}catch{return!1}})))}(e.rawHeaders);if(Er(e.statusCode)){const n=t.get("Location");let o=null;try{o=null===n?null:new URL(n,u.url)}catch{if("manual"!==u.redirect)return l(new cr(`uri requested responds with an invalid redirect URL: ${n}`,"invalid-redirect")),void g()}switch(u.redirect){case"error":return l(new cr(`uri requested responds with a redirect, redirect mode is set to error: ${u.url}`,"no-redirect")),void g();case"manual":break;case"follow":{if(null===o)break;if(u.counter>=u.follow)return l(new cr(`maximum redirect reached at: ${u.url}`,"max-redirect")),void g();const n={headers:new Tr(u.headers),follow:u.follow,counter:u.counter+1,agent:u.agent,compress:u.compress,method:u.method,body:gr(u),signal:u.signal,size:u.size,referrer:u.referrer,referrerPolicy:u.referrerPolicy};if(!((e,t)=>{const r=new URL(t).hostname,n=new URL(e).hostname;return r===n||r.endsWith(`.${n}`)})(u.url,o)||(r=u.url,new URL(o).protocol!==new URL(r).protocol))for(const e of["authorization","www-authenticate","cookie","cookie2"])n.headers.delete(e);if(303!==e.statusCode&&u.body&&s.body instanceof a.Readable)return l(new cr("Cannot follow redirect with body being a readable stream","unsupported-redirect")),void g();303!==e.statusCode&&(301!==e.statusCode&&302!==e.statusCode||"POST"!==u.method)||(n.method="GET",n.body=void 0,n.headers.delete("content-length"));const c=function(e){const t=(e.get("referrer-policy")||"").split(/[,\s]+/);let r="";for(const e of t)e&&Cr.has(e)&&(r=e);return r}(t);return c&&(n.referrerPolicy=c),i(Nr(new Ir(o,n))),void g()}default:return l(new TypeError(`Redirect option '${u.redirect}' is not a valid value of RequestRedirect`))}}var r;f&&e.once("end",(()=>{f.removeEventListener("abort",y)}));let o=a.pipeline(e,new a.PassThrough,(e=>{e&&l(e)}));process.version<"v12.10"&&e.on("aborted",y);const c={url:u.url,status:e.statusCode,statusText:e.statusMessage,headers:t,size:u.size,counter:u.counter,highWaterMark:u.highWaterMark},d=t.get("Content-Encoding");if(!u.compress||"HEAD"===u.method||null===d||204===e.statusCode||304===e.statusCode)return p=new xr(o,c),void i(p);const h={flush:n.Z_SYNC_FLUSH,finishFlush:n.Z_SYNC_FLUSH};if("gzip"===d||"x-gzip"===d)return o=a.pipeline(o,n.createGunzip(h),(e=>{e&&l(e)})),p=new xr(o,c),void i(p);if("deflate"===d||"x-deflate"===d){const t=a.pipeline(e,new a.PassThrough,(e=>{e&&l(e)}));return t.once("data",(e=>{o=8==(15&e[0])?a.pipeline(o,n.createInflate(),(e=>{e&&l(e)})):a.pipeline(o,n.createInflateRaw(),(e=>{e&&l(e)})),p=new xr(o,c),i(p)})),void t.once("end",(()=>{p||(p=new xr(o,c),i(p))}))}if("br"===d)return o=a.pipeline(o,n.createBrotliDecompress(),(e=>{e&&l(e)})),p=new xr(o,c),void i(p);p=new xr(o,c),i(p)})),(async(e,{body:t})=>{null===t?e.end():await pr(t,e)})(_,u).catch(l)}))}class Br{constructor(e,t,r=void 0){this.api_url=r||"https://api.stability.ai",this.api_key=e,this.engine=t}async txt2img(e,t={}){const r=`${this.api_url}/v1/generation/${this.engine}/text-to-image`,n=await Nr(r,{method:"POST",headers:{"Content-Type":"application/json",Accept:"image/png",Authorization:"Bearer "+this.api_key},body:JSON.stringify({clip_guidance_preset:"FAST_BLUE",samples:1,width:t.width??512,height:t.height??512,cfg_scale:t.cfg_scale??7,steps:t.steps??50,text_prompts:[{text:e,weight:1}]})});if(!n.ok)throw new Error(`Non-200 response: ${await n.text()}`);return n}}var zr={id:"stable-diffusion-operation",handler:async({prompt:t,engine:r="stable-diffusion-512-v2-1",api_key:n,width:a=512,height:o=512,cfg_scale:s=7,steps:i=50},{services:l,database:u,getSchema:c,env:d})=>{const{FilesService:h,SettingsService:f}=l,p=await c(),m=new f({schema:p,knex:u}),y=new h({schema:p,knex:u}),_=function(e){if(e.STORAGE_LOCATIONS){const t=String(e.STORAGE_LOCATIONS);return t.includes(",")?t.split(",")[0]:t}return"local"}(d),g=await Ut(m,Ft.field,n),b=new Br(g,r),v=await b.txt2img(t,{width:a,height:o,cfg_scale:s,steps:i});return{id:await y.uploadOne(v.body,{type:"image/png",filename_download:e.randomUUID()+".png",storage:_})}}};const Dr=require("openai");var Mr={id:"davinci-operation",handler:async({text:e,api_key:t,temperature:r=.5,max_tokens:n=2048,top_p:a=1,frequency_penalty:o=0,presence_penalty:s=0},{services:i,database:l,getSchema:u})=>{const{SettingsService:c}=i,d=new c({schema:await u(),knex:l}),h=await Ut(d,Wt.field,t),f=new Dr({apiKey:h});return{response:(await f.completions.create({model:"text-davinci-003",prompt:e,temperature:r,max_tokens:n,top_p:a,frequency_penalty:o,presence_penalty:s})).data.choices[0].text}}};const Wr=require("openai");const Fr=[{name:"configuration",config:({init:e},{services:t,database:r,getSchema:n})=>{const{FieldsService:a}=t;async function o(e,t){await t.readOne(e.collection,e.field).catch((()=>!1))||await t.createField(e.collection,e)}e("routes.custom.after",(async()=>{const e=await n(),t=new a({knex:r,schema:e});await o(Dt,t),await o(Mt,t),await o(Wt,t),await o(Ft,t)}))}}],Ur=[{name:"dall-e-operation",config:Vt},{name:"stable-diffusion-operation",config:zr},{name:"davinci-operation",config:Mr},{name:"chatgpt-operation",config:{id:"chatgpt-operation",handler:async({messages:e,api_key:t,temperature:r=.5,max_tokens:n=null,top_p:a=1,frequency_penalty:o=0,presence_penalty:s=0},{services:i,database:l,getSchema:u})=>{const{SettingsService:c}=i,d=new c({schema:await u(),knex:l}),h=await Ut(d,Wt.field,t),f=await Ut(d,Mt.field,null)||"gpt-4o",p=new Wr({apiKey:h});try{const t=await p.chat.completions.create({model:f,messages:JSON.parse(e),temperature:r,max_tokens:n,top_p:a,frequency_penalty:o,presence_penalty:s});return{response:t.choices[0].message.content,usage:t.usage,finish_reason:t.choices[0].finish_reason,model:t.model}}catch(e){throw e}}}}];let Hr=0;const Vr={START_BOUNDARY:Hr++,HEADER_FIELD_START:Hr++,HEADER_FIELD:Hr++,HEADER_VALUE_START:Hr++,HEADER_VALUE:Hr++,HEADER_VALUE_ALMOST_DONE:Hr++,HEADERS_ALMOST_DONE:Hr++,PART_DATA_START:Hr++,PART_DATA:Hr++,END:Hr++};let Kr=1;const Yr=Kr,Gr=Kr*=2,Qr=e=>32|e,Jr=()=>{};class Xr{constructor(e){this.index=0,this.flags=0,this.onHeaderEnd=Jr,this.onHeaderField=Jr,this.onHeadersEnd=Jr,this.onHeaderValue=Jr,this.onPartBegin=Jr,this.onPartData=Jr,this.onPartEnd=Jr,this.boundaryChars={},e="\r\n--"+e;const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r),this.boundaryChars[t[r]]=!0;this.boundary=t,this.lookbehind=new Uint8Array(this.boundary.length+8),this.state=Vr.START_BOUNDARY}write(e){let t=0;const r=e.length;let n=this.index,{lookbehind:a,boundary:o,boundaryChars:s,index:i,state:l,flags:u}=this;const c=this.boundary.length,d=c-1,h=e.length;let f,p;const m=e=>{this[e+"Mark"]=t},y=e=>{delete this[e+"Mark"]},_=(e,t,r,n)=>{void 0!==t&&t===r||this[e](n&&n.subarray(t,r))},g=(r,n)=>{const a=r+"Mark";a in this&&(n?(_(r,this[a],t,e),delete this[a]):(_(r,this[a],e.length,e),this[a]=0))};for(t=0;t<r;t++)switch(f=e[t],l){case Vr.START_BOUNDARY:if(i===o.length-2){if(45===f)u|=Gr;else if(13!==f)return;i++;break}if(i-1==o.length-2){if(u&Gr&&45===f)l=Vr.END,u=0;else{if(u&Gr||10!==f)return;i=0,_("onPartBegin"),l=Vr.HEADER_FIELD_START}break}f!==o[i+2]&&(i=-2),f===o[i+2]&&i++;break;case Vr.HEADER_FIELD_START:l=Vr.HEADER_FIELD,m("onHeaderField"),i=0;case Vr.HEADER_FIELD:if(13===f){y("onHeaderField"),l=Vr.HEADERS_ALMOST_DONE;break}if(i++,45===f)break;if(58===f){if(1===i)return;g("onHeaderField",!0),l=Vr.HEADER_VALUE_START;break}if(p=Qr(f),p<97||p>122)return;break;case Vr.HEADER_VALUE_START:if(32===f)break;m("onHeaderValue"),l=Vr.HEADER_VALUE;case Vr.HEADER_VALUE:13===f&&(g("onHeaderValue",!0),_("onHeaderEnd"),l=Vr.HEADER_VALUE_ALMOST_DONE);break;case Vr.HEADER_VALUE_ALMOST_DONE:if(10!==f)return;l=Vr.HEADER_FIELD_START;break;case Vr.HEADERS_ALMOST_DONE:if(10!==f)return;_("onHeadersEnd"),l=Vr.PART_DATA_START;break;case Vr.PART_DATA_START:l=Vr.PART_DATA,m("onPartData");case Vr.PART_DATA:if(n=i,0===i){for(t+=d;t<h&&!(e[t]in s);)t+=c;t-=d,f=e[t]}if(i<o.length)o[i]===f?(0===i&&g("onPartData",!0),i++):i=0;else if(i===o.length)i++,13===f?u|=Yr:45===f?u|=Gr:i=0;else if(i-1===o.length)if(u&Yr){if(i=0,10===f){u&=~Yr,_("onPartEnd"),_("onPartBegin"),l=Vr.HEADER_FIELD_START;break}}else u&Gr&&45===f?(_("onPartEnd"),l=Vr.END,u=0):i=0;if(i>0)a[i-1]=f;else if(n>0){const e=new Uint8Array(a.buffer,a.byteOffset,a.byteLength);_("onPartData",0,n,e),n=0,m("onPartData"),t--}break;case Vr.END:break;default:throw new Error(`Unexpected state entered: ${l}`)}g("onHeaderField"),g("onHeaderValue"),g("onPartData"),this.index=i,this.state=l,this.flags=u}end(){if(this.state===Vr.HEADER_FIELD_START&&0===this.index||this.state===Vr.PART_DATA&&this.index===this.boundary.length)this.onPartEnd();else if(this.state!==Vr.END)throw new Error("MultipartParser.end(): stream ended unexpectedly")}}var en=Object.freeze({__proto__:null,toFormData:async function(e,t){if(!/multipart/i.test(t))throw new TypeError("Failed to fetch");const r=t.match(/boundary=(?:"([^"]+)"|([^;]+))/i);if(!r)throw new TypeError("no or bad content-type header, no multipart boundary");const n=new Xr(r[1]||r[2]);let a,o,s,i,l,u;const c=[],d=new lr,h=e=>{s+=y.decode(e,{stream:!0})},f=e=>{c.push(e)},p=()=>{const e=new Xt(c,u,{type:l});d.append(i,e)},m=()=>{d.append(i,s)},y=new TextDecoder("utf-8");y.decode(),n.onPartBegin=function(){n.onPartData=h,n.onPartEnd=m,a="",o="",s="",i="",l="",u=null,c.length=0},n.onHeaderField=function(e){a+=y.decode(e,{stream:!0})},n.onHeaderValue=function(e){o+=y.decode(e,{stream:!0})},n.onHeaderEnd=function(){if(o+=y.decode(),a=a.toLowerCase(),"content-disposition"===a){const e=o.match(/\bname=("([^"]*)"|([^()<>@,;:\\"/[\]?={}\s\t]+))/i);e&&(i=e[2]||e[3]||""),u=function(e){const t=e.match(/\bfilename=("(.*?)"|([^()<>@,;:\\"/[\]?={}\s\t]+))($|;\s)/i);if(!t)return;const r=t[2]||t[3]||"";let n=r.slice(r.lastIndexOf("\\")+1);return n=n.replace(/%22/g,'"'),n=n.replace(/&#(\d{4});/g,((e,t)=>String.fromCharCode(t))),n}(o),u&&(n.onPartData=f,n.onPartEnd=p)}else"content-type"===a&&(l=o);o="",a=""};for await(const t of e)n.write(t);return n.end(),d}});exports.endpoints=[],exports.hooks=Fr,exports.operations=Ur;
